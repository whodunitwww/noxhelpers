return function(a,b,c,d,e,f)local g=b.Player:AddLeftGroupbox("Click To Walk","mouse-pointer")g:AddToggle("ClickToWalk",{Text="Enable Click To Walk",Default=false})g:AddSlider("CTW_Speed",{Text="Walk Speed",Default=16,Min=8,Max=100,Rounding=0,Suffix=" studs/s"})local h=700;local i=0.30;local j=0;local k,l,m,n;local o;local p;local q;local r;local s=nil;local t=0;local function u(v)if not v then return end;for w,x in ipairs(v:GetDescendants())do if x:IsA("BasePart")then a.TweenService:Create(x,TweenInfo.new(0.4),{Transparency=1}):Play()end end;task.delay(0.45,function()if v then v:Destroy()end end)end;local function y()if n then n:Disconnect()n=nil end;if q then u(q)q=nil end end;local function z()if p then u(p)p=nil end end;local function A()y()z()end;local function B()if k then k:Disconnect()k=nil end;if l then l:Disconnect()l=nil end;if m then m:Disconnect()m=nil end;o=nil;r=nil;s=nil;t=0;A()if c.humanoid then c.humanoid.WalkSpeed=16 end end;local function C(D)y()q=Instance.new("Folder")q.Name="CTW_Beacon"q.Parent=workspace;local E=Instance.new("Part")E.Name="Pillar"E.Anchored=true;E.CanCollide=false;E.Material=Enum.Material.Neon;E.Color=Color3.fromRGB(55,235,120)E.Size=Vector3.new(0.25,12,0.25)E.CFrame=CFrame.new(D+Vector3.new(0,E.Size.Y/2,0))E.Parent=q;local F=Instance.new("Part")F.Name="Ring"F.Shape=Enum.PartType.Cylinder;F.Anchored=true;F.CanCollide=false;F.Material=Enum.Material.Neon;F.Color=Color3.fromRGB(55,235,120)F.Size=Vector3.new(2,0.2,2)F.CFrame=CFrame.new(D)*CFrame.Angles(math.rad(90),0,0)F.Parent=q;local G=Instance.new("Part")G.Name="Glow"G.Anchored=true;G.CanCollide=false;G.Material=Enum.Material.Neon;G.Color=Color3.fromRGB(55,235,120)G.Transparency=0.5;G.Size=Vector3.new(1.5,0.15,1.5)G.CFrame=CFrame.new(D+Vector3.new(0,0.05,0))G.Parent=q;a.TweenService:Create(F,TweenInfo.new(0.8,Enum.EasingStyle.Quad,Enum.EasingDirection.Out,-1,true),{Size=Vector3.new(6,F.Size.Y,6)}):Play()a.TweenService:Create(E,TweenInfo.new(0.8,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut,-1,true),{Transparency=0.25}):Play()local H=0;n=a.RunService.Heartbeat:Connect(function(I)H=H+I*math.pi/2;if F and F.Parent then F.CFrame=CFrame.new(D)*CFrame.Angles(math.rad(90),H,0)end end)end;local function J(K)z()p=Instance.new("Folder")p.Name="CTW_Path"p.Parent=workspace;for L=1,#K do local M=Instance.new("Part")M.Name="CTW_Waypoint"M.Anchored=true;M.CanCollide=false;M.Material=Enum.Material.Neon;M.Color=Color3.fromRGB(55,235,120)M.Size=Vector3.new(0.35,0.35,0.35)M.Shape=Enum.PartType.Ball;M.CFrame=CFrame.new(K[L].Position+Vector3.new(0,0.15,0))M.Parent=p end;for L=1,#K-1 do local N,O=K[L].Position,K[L+1].Position;local P=Instance.new("Part")P.Name="CTW_Segment"P.Anchored=true;P.CanCollide=false;P.Material=Enum.Material.Neon;P.Color=Color3.fromRGB(55,235,120)P.Size=Vector3.new(0.15,0.15,(N-O).Magnitude)P.CFrame=CFrame.new((N+O)/2,O)P.Transparency=1;P.Parent=p;a.TweenService:Create(P,TweenInfo.new(0.2),{Transparency=0}):Play()end end;local function Q()A()if l then l:Disconnect()l=nil end;if m then m:Disconnect()m=nil end;o=nil;r=nil;s=nil;t=0;if c.humanoid then c.humanoid.WalkSpeed=16 end end;local function R(S,T)local U=T-S;local V=U.Magnitude;if V<1 then return{T}end;local W=U.Unit;local X={}local Y=0;while Y+h<V do Y=Y+h;X[#X+1]=S+W*Y end;X[#X+1]=T;return X end;local function Z(o,N,O)local _=os.clock()local a0=i-(_-j)if a0>0 then task.wait(a0)end;j=os.clock()local a1,a2=pcall(function()o:ComputeAsync(N,O)end)if not a1 then return false,a2 end;return true,nil end;local function a3(a4,a5)local a6=a.PathfindingService:CreatePath({AgentRadius=2,AgentHeight=5,AgentCanJump=true,WaypointSpacing=4})o=a6;local a1=Z(a6,a4,a5)if not a1 or a6.Status~=Enum.PathStatus.Success then f:Notify("Path segment failed. Trying again with shorter hop...",3)local a7=a4:Lerp(a5,0.5)a1=Z(a6,a4,a7)if not a1 or a6.Status~=Enum.PathStatus.Success then f:Notify("Unable to compute path here.",3)Q()return else table.insert(s,t,a7)end end;local a8=a6:GetWaypoints()if#a8==0 then f:Notify("No waypoints for this segment.",3)Q()return end;J(a8)if m then m:Disconnect()m=nil end;m=a6.Blocked:Connect(function()local a9=c.humanoidRootPart;if a9 and r and s then a3(a9.Position,s[t])end end)if l then l:Disconnect()l=nil end;local L=1;c.humanoid:MoveTo(a8[L].Position)l=c.humanoid.MoveToFinished:Connect(function(aa)if o~=a6 then return end;if not aa then local a9=c.humanoidRootPart;if a9 and s then a3(a9.Position,s[t])end;return end;L=L+1;if a8[L]then c.humanoid:MoveTo(a8[L].Position)else t=t+1;if s and s[t]then local a9=c.humanoidRootPart;if a9 then a3(a9.Position,s[t])else Q()end else Q()end end end)end;local function ab()if k then return end;k=a.UserInputService.InputBegan:Connect(function(ac,ad)if ad then return end;if ac.UserInputType~=Enum.UserInputType.MouseButton1 then return end;local ae=c.player:GetMouse()if not ae or not ae.Hit then return end;local T=ae.Hit.Position;r=T;A()C(T)if c.humanoid then c.humanoid.WalkSpeed=e.CTW_Speed.Value end;local a9=c.humanoidRootPart;if not a9 then return end;s=R(a9.Position,T)t=1;a3(a9.Position,s[t])end)end;d.ClickToWalk:OnChanged(function()if d.ClickToWalk.Value then ab()if c.humanoid then c.humanoid.WalkSpeed=e.CTW_Speed.Value end else B()end end)e.CTW_Speed:OnChanged(function(af)if d.ClickToWalk.Value and c.humanoid then c.humanoid.WalkSpeed=af end end)end
