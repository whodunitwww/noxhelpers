return function(a,b,c,d,e,f)local g=b.Player:AddLeftGroupbox("Click To Walk","mouse-pointer")g:AddToggle("ClickToWalk",{Text="Enable Click To Walk",Default=false})g:AddSlider("CTW_Speed",{Text="Walk Speed",Default=16,Min=8,Max=300,Rounding=0,Suffix=" studs/s"})local h=700;local i=0.30;local j=0;local k,l,m,n;local o;local p;local q;local r;local s=nil;local t=0;local u=false;local v=nil;local function w()if not c.humanoid then return end;if v==nil then v=c.humanoid.WalkSpeed end;c.humanoid.WalkSpeed=e.CTW_Speed.Value end;local function x()if c.humanoid then c.humanoid.WalkSpeed=v or 16 end;v=nil end;local function y(z)if not z then return end;for A,B in ipairs(z:GetDescendants())do if B:IsA("BasePart")then a.TweenService:Create(B,TweenInfo.new(0.4),{Transparency=1}):Play()end end;task.delay(0.45,function()if z then z:Destroy()end end)end;local function C()if n then n:Disconnect()n=nil end;if q then y(q)q=nil end end;local function D()if p then y(p)p=nil end end;local function E()C()D()end;local function F()if k then k:Disconnect()k=nil end;if l then l:Disconnect()l=nil end;if m then m:Disconnect()m=nil end;o=nil;r=nil;s=nil;t=0;E()u=false;x()end;local function G(H)C()q=Instance.new("Folder")q.Name="CTW_Beacon"q.Parent=workspace;local I=Instance.new("Part")I.Name="Pillar"I.Anchored=true;I.CanCollide=false;I.Material=Enum.Material.Neon;I.Color=Color3.fromRGB(55,235,120)I.Size=Vector3.new(0.25,12,0.25)I.CFrame=CFrame.new(H+Vector3.new(0,I.Size.Y/2,0))I.Parent=q;local J=Instance.new("Part")J.Name="Ring"J.Shape=Enum.PartType.Cylinder;J.Anchored=true;J.CanCollide=false;J.Material=Enum.Material.Neon;J.Color=Color3.fromRGB(55,235,120)J.Size=Vector3.new(2,0.2,2)J.CFrame=CFrame.new(H)*CFrame.Angles(math.rad(90),0,0)J.Parent=q;local K=Instance.new("Part")K.Name="Glow"K.Anchored=true;K.CanCollide=false;K.Material=Enum.Material.Neon;K.Color=Color3.fromRGB(55,235,120)K.Transparency=0.5;K.Size=Vector3.new(1.5,0.15,1.5)K.CFrame=CFrame.new(H+Vector3.new(0,0.05,0))K.Parent=q;a.TweenService:Create(J,TweenInfo.new(0.8,Enum.EasingStyle.Quad,Enum.EasingDirection.Out,-1,true),{Size=Vector3.new(6,J.Size.Y,6)}):Play()a.TweenService:Create(I,TweenInfo.new(0.8,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut,-1,true),{Transparency=0.25}):Play()local L=0;n=a.RunService.Heartbeat:Connect(function(M)L=L+M*math.pi/2;if J and J.Parent then J.CFrame=CFrame.new(H)*CFrame.Angles(math.rad(90),L,0)end end)end;local function N(O)D()p=Instance.new("Folder")p.Name="CTW_Path"p.Parent=workspace;for P=1,#O do local Q=Instance.new("Part")Q.Name="CTW_Waypoint"Q.Anchored=true;Q.CanCollide=false;Q.Material=Enum.Material.Neon;Q.Color=Color3.fromRGB(55,235,120)Q.Size=Vector3.new(0.35,0.35,0.35)Q.Shape=Enum.PartType.Ball;Q.CFrame=CFrame.new(O[P].Position+Vector3.new(0,0.15,0))Q.Parent=p end;for P=1,#O-1 do local R,S=O[P].Position,O[P+1].Position;local T=Instance.new("Part")T.Name="CTW_Segment"T.Anchored=true;T.CanCollide=false;T.Material=Enum.Material.Neon;T.Color=Color3.fromRGB(55,235,120)T.Size=Vector3.new(0.15,0.15,(R-S).Magnitude)T.CFrame=CFrame.new((R+S)/2,S)T.Transparency=1;T.Parent=p;a.TweenService:Create(T,TweenInfo.new(0.2),{Transparency=0}):Play()end end;local function U()E()if l then l:Disconnect()l=nil end;if m then m:Disconnect()m=nil end;o=nil;r=nil;s=nil;t=0;u=false;x()end;local function V(W,X)local Y=X-W;local Z=Y.Magnitude;if Z<1 then return{X}end;local _=Y.Unit;local a0={}local a1=0;while a1+h<Z do a1=a1+h;a0[#a0+1]=W+_*a1 end;a0[#a0+1]=X;return a0 end;local function a2(o,R,S)local a3=os.clock()local a4=i-(a3-j)if a4>0 then task.wait(a4)end;j=os.clock()local a5,a6=pcall(function()o:ComputeAsync(R,S)end)if not a5 then return false,a6 end;return true,nil end;local function a7(a8,a9)local aa=a.PathfindingService:CreatePath({AgentRadius=2,AgentHeight=5,AgentCanJump=true,WaypointSpacing=4})o=aa;local a5=a2(aa,a8,a9)if not a5 or aa.Status~=Enum.PathStatus.Success then f:Notify("Path segment failed. Trying again with shorter hop...",3)local ab=a8:Lerp(a9,0.5)a5=a2(aa,a8,ab)if not a5 or aa.Status~=Enum.PathStatus.Success then f:Notify("Unable to compute path here.",3)U()return else table.insert(s,t,ab)end end;local ac=aa:GetWaypoints()if#ac==0 then f:Notify("No waypoints for this segment.",3)U()return end;N(ac)if m then m:Disconnect()m=nil end;m=aa.Blocked:Connect(function()local ad=c.humanoidRootPart;if ad and r and s then a7(ad.Position,s[t])end end)if l then l:Disconnect()l=nil end;local P=1;c.humanoid:MoveTo(ac[P].Position)l=c.humanoid.MoveToFinished:Connect(function(ae)if o~=aa then return end;if not ae then local ad=c.humanoidRootPart;if ad and s then a7(ad.Position,s[t])end;return end;P=P+1;if ac[P]then c.humanoid:MoveTo(ac[P].Position)else t=t+1;if s and s[t]then local ad=c.humanoidRootPart;if ad then a7(ad.Position,s[t])else U()end else U()end end end)end;local function af()if k then return end;k=a.UserInputService.InputBegan:Connect(function(ag,ah)if ah then return end;if ag.UserInputType~=Enum.UserInputType.MouseButton1 then return end;local ai=c.player:GetMouse()if not ai or not ai.Hit then return end;local X=ai.Hit.Position;r=X;E()G(X)u=true;w()local ad=c.humanoidRootPart;if not ad then return end;s=V(ad.Position,X)t=1;a7(ad.Position,s[t])end)end;d.ClickToWalk:OnChanged(function()if d.ClickToWalk.Value then af()else F()end end)e.CTW_Speed:OnChanged(function(aj)if u and c.humanoid then c.humanoid.WalkSpeed=aj end end)end
