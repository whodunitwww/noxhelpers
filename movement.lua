return function(a)local b=a.Services;local c=a.Tabs;local d=a.References;local e=a.Library;local f=a.Options;local g=a.Toggles;local h=a.LPH_NO_VIRTUALIZE or function(i)return i end;local j={}local k=c.Player:AddLeftGroupbox("Flight","move-3d")k:AddToggle("FlightEnabled",{Text="Flight",Default=false}):AddKeyPicker("FlightKey",{Default="Y",SyncToggleState=true,Mode="Toggle"})k:AddSlider("FlightSpeed",{Text="Flight Speed",Default=100,Min=30,Max=400,Rounding=0})local l;local function m()if l then return end;e:Notify("Flight enabled.",2)l=b.RunService.RenderStepped:Connect(h(function()if not d.humanoidRootPart or not d.camera then return end;local n=d.camera.CFrame;local o,p,q=n.LookVector,n.RightVector,n.UpVector;local r=Vector3.zero;local s=Enum.KeyCode;if b.UserInputService:IsKeyDown(s.W)then r=r+o end;if b.UserInputService:IsKeyDown(s.S)then r=r-o end;if b.UserInputService:IsKeyDown(s.A)then r=r-p end;if b.UserInputService:IsKeyDown(s.D)then r=r+p end;if b.UserInputService:IsKeyDown(s.Space)then r=r+q end;if b.UserInputService:IsKeyDown(s.LeftShift)or b.UserInputService:IsKeyDown(s.LeftControl)then r=r-q end;if d.humanoid and b.UserInputService.TouchEnabled then local t=d.humanoid.MoveDirection;if t.Magnitude>0 then r=r+o*t.Z*-1+p*t.X end end;local u=f.FlightSpeed.Value;if r.Magnitude>0 then d.humanoidRootPart.AssemblyAngularVelocity=Vector3.zero;d.humanoidRootPart.AssemblyLinearVelocity=r.Unit*u else d.humanoidRootPart.AssemblyAngularVelocity=Vector3.zero;d.humanoidRootPart.AssemblyLinearVelocity=Vector3.new(0,2.2,0)end end))end;local function v()if l then e:Notify("Flight disabled.",2)l:Disconnect()l=nil;if d.humanoidRootPart then d.humanoidRootPart.AssemblyAngularVelocity=Vector3.zero;d.humanoidRootPart.AssemblyLinearVelocity=Vector3.zero end end end;g.FlightEnabled:OnChanged(function()if g.FlightEnabled.Value then m()else v()end end)local w=c.Player:AddLeftGroupbox("Speed","move")w:AddToggle("SpeedEnabled",{Text="Speed",Default=false}):AddKeyPicker("SpeedKey",{Default="G",SyncToggleState=true,Mode="Toggle"})w:AddSlider("SpeedValue",{Text="Speed Value",Default=30,Min=16,Max=300,Rounding=0})local x;local function y()if x then return end;e:Notify("Speed enabled.",2)x=b.RunService.Heartbeat:Connect(h(function()if d.humanoid then local u=f.SpeedValue.Value;d.humanoid.WalkSpeed=u end end))end;local function z()if x then e:Notify("Speed disabled.",2)x:Disconnect()x=nil end;if d.humanoid then d.humanoid.WalkSpeed=16 end end;g.SpeedEnabled:OnChanged(function()if g.SpeedEnabled.Value then y()else z()end end)local A=c.Player:AddLeftGroupbox("Jump","move-vertical")A:AddToggle("JumpPower",{Text="Jump Power",Default=false})A:AddSlider("JumpHeight",{Text="Jump Height",Default=7.2,Min=5,Max=200,Rounding=1})A:AddToggle("InfiniteJump",{Text="Infinite Jump",Default=false})local function B()if not d.humanoid then return end;local C=tonumber(f.JumpHeight.Value)or 50;local D=workspace.Gravity or 196.2;local E=math.sqrt(math.max(0,2*D*C))if d.humanoid.UseJumpPower~=nil then d.humanoid.UseJumpPower=true end;if d.humanoid.JumpPower~=nil then d.humanoid.JumpPower=E end end;local F=nil;local G;local function H()if G then return end;local I=d.humanoid;if I and not F then F={UseJumpPower=I.UseJumpPower,JumpPower=I.JumpPower,JumpHeight=I.JumpHeight}end;B()G=b.RunService.Heartbeat:Connect(h(function()B()end))end;local function J()if G then G:Disconnect()G=nil end;local I=d.humanoid;if I and F then if I.UseJumpPower~=nil then I.UseJumpPower=F.UseJumpPower end;if I.JumpPower~=nil then I.JumpPower=F.JumpPower end;if I.JumpHeight~=nil then I.JumpHeight=F.JumpHeight end end end;local K,L=nil,false;local function M()if K then return end;K=b.UserInputService.JumpRequest:Connect(h(function()if not g.InfiniteJump.Value then return end;local I=d.humanoid;if not I or L then return end;L=true;task.defer(function()pcall(function()I:ChangeState(Enum.HumanoidStateType.Jumping)I.Jump=true end)task.wait()L=false end)end))end;local function N()if K then K:Disconnect()K=nil end;L=false end;g.JumpPower:OnChanged(function()if g.JumpPower.Value then H()else J()end end)f.JumpHeight:OnChanged(function()if g.JumpPower.Value then B()end end)g.InfiniteJump:OnChanged(function()if g.InfiniteJump.Value then M()else N()end end)local O=c.Player:AddLeftGroupbox("Click Teleport","mouse-pointer-click")O:AddToggle("ClickTPEnabled",{Text="Click To Teleport",Default=false,Tooltip="Hold the chosen key and right-click anywhere to instantly teleport there."}):AddKeyPicker("ClickTPKey",{Default="Q",SyncToggleState=false,Mode="Hold"})local P;local function Q()if P then return end;P=b.UserInputService.InputBegan:Connect(function(R,S)if S then return end;if R.UserInputType==Enum.UserInputType.MouseButton2 and b.UserInputService:IsKeyDown(Enum.KeyCode[f.ClickTPKey.Value])then local T=b.UserInputService:GetMouseLocation()local U=d.camera:ViewportPointToRay(T.X,T.Y)local V=workspace:Raycast(U.Origin,U.Direction*1000,RaycastParams.new())if V and d.humanoidRootPart then d.humanoidRootPart.CFrame=CFrame.new(V.Position+Vector3.new(0,3,0))end end end)end;local function W()if P then P:Disconnect()P=nil end end;g.ClickTPEnabled:OnChanged(function()if g.ClickTPEnabled.Value then Q()else W()end end)f.ClickTPKey:OnChanged(function()end)local X=c.Player:AddLeftGroupbox("Click To Walk","mouse-pointer")X:AddToggle("ClickToWalk",{Text="Enable Click To Walk",Default=false})X:AddSlider("CTW_Speed",{Text="Walk Speed",Default=16,Min=8,Max=300,Rounding=0,Suffix=" studs/s"})local Y=700;local Z=0.30;local _=0;local a0,a1,a2,a3;local a4;local a5;local a6;local a7;local a8=nil;local a9=0;local aa=false;local ab=nil;local ac={}local function ad()local I=d.humanoid;if not I then return end;if ab==nil then ab=I.WalkSpeed end;I.WalkSpeed=f.CTW_Speed.Value end;local function ae()local I=d.humanoid;if I and ab~=nil then I.WalkSpeed=ab end;ab=nil end;local function af(ag)if not ag then return end;for ah,ai in ipairs(ag:GetDescendants())do if ai:IsA("BasePart")then b.TweenService:Create(ai,TweenInfo.new(0.25),{Transparency=1}):Play()end end;task.delay(0.3,function()pcall(function()if ag then ag:Destroy()end end)end)end;local function aj()if a3 then a3:Disconnect()a3=nil end;if a6 then af(a6)a6=nil end end;local function ak()if a5 then af(a5)a5=nil end end;local function al()aj()ak()end;local function am()local I,an=d.humanoid,d.humanoidRootPart;if I then pcall(function()if an then I:MoveTo(an.Position)end end)pcall(function()I:Move(Vector3.zero)end)end end;local function ao()if a1 then a1:Disconnect()a1=nil end;if a2 then a2:Disconnect()a2=nil end;a4=nil end;local function ap()for aq,ar in pairs(ac)do if ar then ar:Disconnect()end;ac[aq]=nil end end;local function as()if not aa then al()ao()ae()ap()a7,a8,a9=nil,nil,0;return end;aa=false;am()al()ao()ae()ap()a7,a8,a9=nil,nil,0 end;local function at()as()if a0 then a0:Disconnect()a0=nil end end;local function au(av)aj()a6=Instance.new("Folder")a6.Name="CTW_Beacon"a6.Parent=workspace;local aw=Instance.new("Part")aw.Name="Pillar"aw.Anchored,aw.CanCollide=true,false;aw.Material=Enum.Material.Neon;aw.Color=Color3.fromRGB(55,235,120)aw.Size=Vector3.new(0.25,12,0.25)aw.CFrame=CFrame.new(av+Vector3.new(0,aw.Size.Y/2,0))aw.Parent=a6;local ax=Instance.new("Part")ax.Name="Ring"ax.Shape=Enum.PartType.Cylinder;ax.Anchored,ax.CanCollide=true,false;ax.Material=Enum.Material.Neon;ax.Color=Color3.fromRGB(55,235,120)ax.Size=Vector3.new(2,0.2,2)ax.CFrame=CFrame.new(av)*CFrame.Angles(math.rad(90),0,0)ax.Parent=a6;local ay=Instance.new("Part")ay.Name="Glow"ay.Anchored,ay.CanCollide=true,false;ay.Material=Enum.Material.Neon;ay.Color=Color3.fromRGB(55,235,120)ay.Transparency=0.5;ay.Size=Vector3.new(1.5,0.15,1.5)ay.CFrame=CFrame.new(av+Vector3.new(0,0.05,0))ay.Parent=a6;b.TweenService:Create(ax,TweenInfo.new(0.8,Enum.EasingStyle.Quad,Enum.EasingDirection.Out,-1,true),{Size=Vector3.new(6,ax.Size.Y,6)}):Play()b.TweenService:Create(aw,TweenInfo.new(0.8,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut,-1,true),{Transparency=0.25}):Play()local az=0;a3=b.RunService.Heartbeat:Connect(function(aA)if not ax or not ax.Parent then return end;az=az+aA*math.pi/2;ax.CFrame=CFrame.new(av)*CFrame.Angles(math.rad(90),az,0)end)end;local function aB(aC)ak()a5=Instance.new("Folder")a5.Name="CTW_Path"a5.Parent=workspace;for aD=1,#aC do local aE=Instance.new("Part")aE.Name="CTW_Waypoint"aE.Anchored,aE.CanCollide=true,false;aE.Material=Enum.Material.Neon;aE.Color=Color3.fromRGB(55,235,120)aE.Size=Vector3.new(0.35,0.35,0.35)aE.Shape=Enum.PartType.Ball;aE.CFrame=CFrame.new(aC[aD].Position+Vector3.new(0,0.15,0))aE.Parent=a5 end;for aD=1,#aC-1 do local aF,aG=aC[aD].Position,aC[aD+1].Position;local aH=Instance.new("Part")aH.Name="CTW_Segment"aH.Anchored,aH.CanCollide=true,false;aH.Material=Enum.Material.Neon;aH.Color=Color3.fromRGB(55,235,120)aH.Size=Vector3.new(0.15,0.15,(aF-aG).Magnitude)aH.CFrame=CFrame.new((aF+aG)/2,aG)aH.Transparency=1;aH.Parent=a5;b.TweenService:Create(aH,TweenInfo.new(0.2),{Transparency=0}):Play()end end;local function aI(aJ,aK)local aL=aK-aJ;local aM=aL.Magnitude;if aM<1 then return{aK}end;local r=aL.Unit;local aN,aO={},0;while aO+Y<aM do aO=aO+Y;aN[#aN+1]=aJ+r*aO end;aN[#aN+1]=aK;return aN end;local function aP(aQ,aF,aG)local aR=os.clock()local aS=Z-(aR-_)if aS>0 then task.wait(aS)end;_=os.clock()local aT,aU=pcall(function()aQ:ComputeAsync(aF,aG)end)if not aT then return false,aU end;return true end;local function aV()ap()ac.WASD=b.UserInputService.InputBegan:Connect(function(R,S)if S then return end;local aW=R.KeyCode;if aW==Enum.KeyCode.W or aW==Enum.KeyCode.A or aW==Enum.KeyCode.S or aW==Enum.KeyCode.D then as()end end)ac.GP=b.UserInputService.InputChanged:Connect(function(R,S)if S then return end;if R.UserInputType==Enum.UserInputType.Gamepad1 and R.KeyCode==Enum.KeyCode.Thumbstick1 then if R.Position.Magnitude>0.15 then as()end end end)ac.RMB=b.UserInputService.InputBegan:Connect(function(R,S)if S then return end;if R.UserInputType==Enum.UserInputType.MouseButton2 then as()end end)if d.player then ac.CharAdded=d.player.CharacterAdded:Connect(function()as()end)end;local I=d.humanoid;if I then ac.Died=I.Died:Connect(as)ac.Seated=I.Seated:Connect(function(aX)if aX then as()end end)ac.Ancestry=I.AncestryChanged:Connect(function(ah,aY)if aY==nil then as()end end)end end;local function aZ(a_,b0)if not aa then return end;local b1=b.PathfindingService:CreatePath({AgentRadius=2,AgentHeight=5,AgentCanJump=true,WaypointSpacing=4})a4=b1;local aT=aP(b1,a_,b0)if not aT or b1.Status~=Enum.PathStatus.Success then local b2=a_:Lerp(b0,0.5)aT=aP(b1,a_,b2)if not aT or b1.Status~=Enum.PathStatus.Success then e:Notify("Unable to compute path.",3)as()return else if a8 then table.insert(a8,a9,b2)end end end;if not aa then return end;local b3=b1:GetWaypoints()if#b3==0 then e:Notify("No waypoints for this segment.",3)as()return end;aB(b3)if a2 then a2:Disconnect()a2=nil end;a2=b1.Blocked:Connect(function()if not aa then return end;local an=d.humanoidRootPart;if an and a7 and a8 then aZ(an.Position,a8[a9])end end)if a1 then a1:Disconnect()a1=nil end;local aD=1;local I=d.humanoid;if not I then as()return end;I:MoveTo(b3[aD].Position)a1=I.MoveToFinished:Connect(function(b4)if not aa then return end;if a4~=b1 then return end;if not b4 then local an=d.humanoidRootPart;if an and a8 then aZ(an.Position,a8[a9])else as()end;return end;aD=aD+1;if b3[aD]then I:MoveTo(b3[aD].Position)else a9=a9+1;if a8 and a8[a9]then local an=d.humanoidRootPart;if an then aZ(an.Position,a8[a9])else as()end else as()end end end)end;local function b5()if a0 then return end;a0=b.UserInputService.InputBegan:Connect(function(R,S)if S then return end;if R.UserInputType~=Enum.UserInputType.MouseButton1 then return end;local b6=d.player and d.player:GetMouse()if not b6 or not b6.Hit then return end;local aK=b6.Hit.Position;if aa then as()end;a7=aK;al()au(aK)local an=d.humanoidRootPart;local I=d.humanoid;if not(an and I)then as()return end;aa=true;ad()aV()a8=aI(an.Position,aK)a9=1;aZ(an.Position,a8[a9])end)end;g.ClickToWalk:OnChanged(function()if g.ClickToWalk.Value then b5()else at()end end)f.CTW_Speed:OnChanged(function(u)if aa and d.humanoid then d.humanoid.WalkSpeed=u end end)j.startFlight=m;j.startSpeed=y;j.startJumpMod=H;j.startInfiniteJump=M;j.stopFlight=v;j.stopSpeed=z;j.stopJumpMod=J;j.stopInfiniteJump=N;function j.Unload()v()z()J()N()W()at()end;return j end
