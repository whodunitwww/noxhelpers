return function(a,b,c,d,e,f)local g,h,i,j,k,l,m=a.RunService,a.Lighting,a.Players,a.ContextActionService,a.UserInputService,a.StarterGui,a.Workspace;local n=b.Player:AddRightGroupbox("Visuals","glasses")n:AddToggle("InfiniteCamera",{Text="Infinite Camera Max",Default=false})local o;d.InfiniteCamera:OnChanged(function()local p=c.player;if not p then return end;if d.InfiniteCamera.Value then o=o or p.CameraMaxZoomDistance;p.CameraMaxZoomDistance=1e10 else p.CameraMaxZoomDistance=o or 128;o=nil end end)n:AddToggle("NoFog",{Text="No Fog",Default=false})local q,r;local function s(t)if not r then return end;if t:IsA("BloomEffect")or t:IsA("SunRaysEffect")or t:IsA("DepthOfFieldEffect")or t:IsA("ColorCorrectionEffect")or t:IsA("BlurEffect")then if t.Enabled then t:SetAttribute("NFWasEnabled",true)t.Enabled=false end elseif t:IsA("Atmosphere")then if r.Atmo[t]==nil then r.Atmo[t]={D=t.Density,H=t.Haze,O=t.Offset,G=t.Glare}end;t.Density=0;t.Haze=0;t.Glare=0 end end;local function u()if r then return end;r={FogEnd=h.FogEnd,FogStart=h.FogStart,FogColor=h.FogColor,Atmo={}}h.FogEnd,h.FogStart=1e10,1e10;for v,w in ipairs(h:GetDescendants())do s(w)end;q=h.DescendantAdded:Connect(s)end;local function x()if not r then return end;if q then q:Disconnect()q=nil end;h.FogEnd,h.FogStart,h.FogColor=r.FogEnd,r.FogStart,r.FogColor;for v,w in ipairs(h:GetDescendants())do if w:GetAttribute("NFWasEnabled")then w:SetAttribute("NFWasEnabled",nil)if w.Enabled~=nil then w.Enabled=true end end end;for y,z in pairs(r.Atmo)do if y and y.Parent then y.Density,y.Haze,y.Offset,y.Glare=z.D,z.H,z.O,z.G end end;r=nil end;d.NoFog:OnChanged(function()if d.NoFog.Value then u()else x()end end)n:AddToggle("XRay",{Text="X-Ray",Default=false,Tooltip="See through structures"})local function A(B)for v,C in ipairs(m:GetDescendants())do if C:IsA("BasePart")then if not C.Parent:FindFirstChildOfClass("Humanoid")and not(C.Parent.Parent and C.Parent.Parent:FindFirstChildOfClass("Humanoid"))then C.LocalTransparencyModifier=B and 0.5 or 0 end end end end;d.XRay:OnChanged(function()A(d.XRay.Value)end)n:AddToggle("Fullbright",{Text="Fullbright",Default=false})n:AddSlider("Fullbright_Brightness",{Text="Brightness",Default=2,Min=1,Max=10,Rounding=1})local D,E;local function F()if D then return end;E=E or{B=h.Brightness,GS=h.GlobalShadows,A=h.Ambient}D=g.RenderStepped:Connect(function()h.Brightness=e.Fullbright_Brightness.Value;h.GlobalShadows=false;h.Ambient=Color3.new(1,1,1)end)end;local function G()if D then D:Disconnect()D=nil end;if E then h.Brightness=E.B;h.GlobalShadows=E.GS;h.Ambient=E.A;E=nil end end;d.Fullbright:OnChanged(function()if d.Fullbright.Value then F()else G()end end)n:AddSlider("CameraFOV",{Text="Camera FOV",Default=70,Min=40,Max=120,Rounding=0})local function H()if c.camera then c.camera.FieldOfView=e.CameraFOV.Value end end;e.CameraFOV:OnChanged(H)H()n:AddToggle("FreecamEnabled",{Text="Freecam",Default=false}):AddKeyPicker("FreecamKey",{Default="P",SyncToggleState=true,Mode="Toggle",Text="Freecam Key"})n:AddSlider("FreecamSensitivity",{Text="Freecam Sensitivity",Default=1.0,Min=0.1,Max=3.0,Rounding=2,Tooltip="Scales look + movement speed"})local I=m.CurrentCamera;m:GetPropertyChangedSignal("CurrentCamera"):Connect(function()I=m.CurrentCamera end)local J,K,L,M,N,O,P,Q=math.pi,math.exp,math.rad,math.sqrt,math.tan,math.abs,math.clamp,math.sign;local R=L(90)local S={}S.__index=S;function S.new(T,U)return setmetatable({f=T,p=U,v=U*0},S)end;function S:Update(V,W)local X=self.f*2*J;local Y,Z=self.p,self.v;local _=W-Y;local a0=K(-X*V)local a1=W+(Z*V-_*(X*V+1))*a0;local a2=(X*V*(_*X-Z)+Z)*a0;self.p,self.v=a1,a2;return a1 end;function S:Reset(U)self.p=U;self.v=U*0 end;local a3=S.new(1.5,Vector3.new())local a4=S.new(1.0,Vector2.new())local a5=S.new(4.0,0)local a6,a7,a8=Vector3.new(),Vector2.new(),70;local a9=1;local aa={KB="CerbFC_Keyboard",MousePan="CerbFC_MousePan",Wheel="CerbFC_MouseWheel",GPBtn="CerbFC_GPBtn",GPTrig="CerbFC_GPTrig",GPThumb="CerbFC_GPThumb",Touch="CerbFC_Touch"}local ab={ButtonX=0,ButtonY=0,ButtonL2=0,ButtonR2=0,Thumbstick1=Vector2.new(),Thumbstick2=Vector2.new()}local ac={W=0,A=0,S=0,D=0,E=0,Q=0,U=0,H=0,J=0,K=0,I=0,Y=0,Up=0,Down=0}local ad={Delta=Vector2.new(),MouseWheel=0}local ae=Vector2.new()local af=Vector2.new()local function ag(ah)local ai,aj=2.0,0.15;local function ak(C)return(K(ai*C)-1)/(K(ai)-1)end;local function al(C)return ak((C-aj)/(1-aj))end;return Q(ah)*P(al(O(ah)),0,1)end;local am={}local function an()j:BindActionAtPriority(aa.KB,function(v,ao,ap)ac[ap.KeyCode.Name]=ao==Enum.UserInputState.Begin and 1 or 0;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.W,Enum.KeyCode.U,Enum.KeyCode.A,Enum.KeyCode.H,Enum.KeyCode.S,Enum.KeyCode.J,Enum.KeyCode.D,Enum.KeyCode.K,Enum.KeyCode.E,Enum.KeyCode.I,Enum.KeyCode.Q,Enum.KeyCode.Y,Enum.KeyCode.Up,Enum.KeyCode.Down)j:BindActionAtPriority(aa.MousePan,function(v,v,ap)local w=ap.Delta;ad.Delta=ad.Delta+Vector2.new(-w.y,-w.x)return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.UserInputType.MouseMovement)j:BindActionAtPriority(aa.Wheel,function(v,v,ap)ad[ap.UserInputType.Name]=ad[ap.UserInputType.Name]-ap.Position.z;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.UserInputType.MouseWheel)j:BindActionAtPriority(aa.GPBtn,function(v,ao,ap)ab[ap.KeyCode.Name]=ao==Enum.UserInputState.Begin and 1 or 0;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.ButtonX,Enum.KeyCode.ButtonY)j:BindActionAtPriority(aa.GPTrig,function(v,v,ap)ab[ap.KeyCode.Name]=ap.Position.z;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.ButtonR2,Enum.KeyCode.ButtonL2)j:BindActionAtPriority(aa.GPThumb,function(v,v,ap)ab[ap.KeyCode.Name]=ap.Position;return Enum.ContextActionResult.Sink end,false,Enum.ContextActionPriority.High.Value,Enum.KeyCode.Thumbstick1,Enum.KeyCode.Thumbstick2)if k.TouchEnabled then local aq={}local ar;am[1]=k.TouchStarted:Connect(function(ap,as)aq[ap]=ap.Position end)am[2]=k.TouchMoved:Connect(function(ap,as)local at=aq[ap]aq[ap]=ap.Position;if not at then return end;local au,av=nil,nil;local aw=0;for ax,v in pairs(aq)do aw=aw+1;if aw==1 then au=ax elseif aw==2 then av=ax end end;if aw==1 then local w=ap.Delta;ae=ae+Vector2.new(-w.Y,-w.X)elseif aw>=2 and au and av then local ay=aq[au]local az=aq[av]local aA=au==ap and at or au.Position;local aB=av==ap and(aq[av]or av.Position)or av.Position;local aC=(ay-aA+az-aB)*0.5;af=af+Vector2.new(aC.X,-aC.Y)local aD=(ay-az).Magnitude;local aE=(aA-aB).Magnitude;local aF=aD-aE;ad.MouseWheel=ad.MouseWheel+aF/75 end end)am[3]=k.TouchEnded:Connect(function(ap,as)aq[ap]=nil;ar=nil end)end end;local function aG()a9=1;for aH in pairs(ab)do ab[aH]=typeof(ab[aH])=="Vector2"and Vector2.new()or 0 end;for aH in pairs(ac)do ac[aH]=0 end;ad.Delta=Vector2.new()ad.MouseWheel=0;ae=Vector2.new()af=Vector2.new()for v,aI in pairs(aa)do j:UnbindAction(aI)end;for v,aJ in ipairs(am)do if aJ then aJ:Disconnect()end end;table.clear(am)end;local aK={}local function aL()aK.core={Backpack=l:GetCoreGuiEnabled(Enum.CoreGuiType.Backpack),Chat=l:GetCoreGuiEnabled(Enum.CoreGuiType.Chat),Health=l:GetCoreGuiEnabled(Enum.CoreGuiType.Health),PlayerList=l:GetCoreGuiEnabled(Enum.CoreGuiType.PlayerList)}for aH,C in pairs(aK.core)do l:SetCoreGuiEnabled(Enum.CoreGuiType[aH],false)end;local aM=i.LocalPlayer:FindFirstChildOfClass("PlayerGui")aK.screens={}if aM then for v,aN in ipairs(aM:GetChildren())do if aN:IsA("ScreenGui")and aN.Enabled then aK.screens[#aK.screens+1]=aN;aN.Enabled=false end end end end;local function aO()if aK.core then for aH,C in pairs(aK.core)do l:SetCoreGuiEnabled(Enum.CoreGuiType[aH],C)end end;if aK.screens then for v,aN in ipairs(aK.screens)do if aN.Parent then aN.Enabled=true end end end;aK={}end;local aP,aQ,aR;local function aS()aP=c.humanoid;if aP and aP.SetStateEnabled then aQ=aP:GetStateEnabled(Enum.HumanoidStateType.Jumping)aP:SetStateEnabled(Enum.HumanoidStateType.Jumping,false)end;if k and k.JumpRequest then aR=k.JumpRequest:Connect(function()if aP then aP.Jump=false end end)end end;local function aT()if aR then aR:Disconnect()aR=nil end;if aP and aP.SetStateEnabled then aP:SetStateEnabled(Enum.HumanoidStateType.Jumping,aQ~=false)end;aP=nil;aQ=nil end;local function aU(V,aV)a9=P(a9+V*(ac.Up-ac.Down)*0.75,0.01,4)local aW=Vector3.new(ag(ab.Thumbstick1.X),ag(ab.ButtonR2)-ag(ab.ButtonL2),ag(-ab.Thumbstick1.Y))local aH=Vector3.new(ac.D-ac.A+ac.K-ac.H,ac.E-ac.Q+ac.I-ac.Y,ac.S-ac.W+ac.J-ac.U)local aX=af;af=Vector2.new()local aY=Vector3.new(aX.X,0,aX.Y)*0.03;local aZ=k:IsKeyDown(Enum.KeyCode.LeftShift)or k:IsKeyDown(Enum.KeyCode.RightShift)return(aW+aH+aY)*64*a9*(aZ and 0.25 or 1)*aV end;local function a_(V,aV)local b0=Vector2.new(ag(ab.Thumbstick2.Y),ag(-ab.Thumbstick2.X))*J/8;local b1=ad.Delta+ae;ae=Vector2.new()b1=b1*J/64;ad.Delta=Vector2.new()return(b0+b1)*8*aV end;local function b2()local b0=(ab.ButtonX-ab.ButtonY)*0.25;local b3=ad.MouseWheel*1.0;ad.MouseWheel=0;return b0+b3 end;local b4=false;local function b5(V)local aV=e.FreecamSensitivity.Value or 1;local b6=a3:Update(V,aU(V,aV))local b7=a4:Update(V,a_(V,aV))local b8=a5:Update(V,b2())local b9=M(N(L(70/2))/N(L(a8/2)))a8=P(a8+b8*300*V/b9,1,120)a7=a7+b7*V/b9;a7=Vector2.new(P(a7.X,-R,R),a7.Y%(2*J))local ba=CFrame.new(a6)*CFrame.fromOrientation(a7.X,a7.Y,0)*CFrame.new(b6*V)a6=ba.Position;I.CFrame=ba;I.Focus=ba;I.FieldOfView=a8 end;local function bb()if b4 then return end;local ba=I.CFrame;a7=Vector2.new(ba:toEulerAnglesYXZ())a6=ba.Position;a8=I.FieldOfView;a3:Reset(Vector3.new())a4:Reset(Vector2.new())a5:Reset(0)aL()aS()I.CameraType=Enum.CameraType.Scriptable;if not k.TouchEnabled then k.MouseIconEnabled=false;k.MouseBehavior=Enum.MouseBehavior.LockCenter end;an()g:BindToRenderStep("CerbFreecam",Enum.RenderPriority.Camera.Value,b5)b4=true end;local function bc()if not b4 then return end;g:UnbindFromRenderStep("CerbFreecam")aG()aT()I.CameraType=Enum.CameraType.Custom;if not k.TouchEnabled then k.MouseBehavior=Enum.MouseBehavior.Default;k.MouseIconEnabled=true end;ad.Delta=Vector2.new()ad.MouseWheel=0;aO()b4=false end;d.FreecamEnabled:OnChanged(function()if d.FreecamEnabled.Value then bb()else bc()end end)f:OnUnload(function()if d.InfiniteCamera and d.InfiniteCamera.Value then d.InfiniteCamera:SetValue(false)end;if d.NoFog and d.NoFog.Value then d.NoFog:SetValue(false)end;if d.XRay and d.XRay.Value then d.XRay:SetValue(false)end;if d.Fullbright and d.Fullbright.Value then d.Fullbright:SetValue(false)end;if d.FreecamEnabled and d.FreecamEnabled.Value then d.FreecamEnabled:SetValue(false)end;G()x()A(false)if b4 then bc()end end)end
