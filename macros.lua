return function(a)local b=a.Services;local c=a.Tabs;local d=a.Library;local e=a.References;local f=a.MoveToPos;local g=Color3.fromRGB(6,8,10)local h=Color3.fromRGB(12,14,18)local i=Color3.fromRGB(18,20,26)local j=Color3.fromRGB(220,240,230)local k=Color3.fromRGB(170,195,185)local l=Color3.fromRGB(90,255,140)local m=Color3.fromRGB(60,120,80)local n=c.Auto:AddLeftGroupbox("Macros (Runner)","workflow")local o=("Cerberus/%s"):format(e.gameName or"Game")local p=("%s/macros.json"):format(o)local q={list={},order={},_hotkeyConn=nil,_hb=nil}local r={gui=nil,state={selected=nil},refs={}}local s={[" "]="Space",Spacebar="Space",Space="Space",Ctrl="LeftControl",Control="LeftControl",LCtrl="LeftControl",RCtrl="RightControl",Shift="LeftShift",LShift="LeftShift",RShift="RightShift",Alt="LeftAlt",LAlt="LeftAlt",RAlt="RightAlt",["`"]="Backquote",Backtick="Backquote",BackQuote="Backquote",["1"]="One",["2"]="Two",["3"]="Three",["4"]="Four",["5"]="Five",["6"]="Six",["7"]="Seven",["8"]="Eight",["9"]="Nine",["0"]="Zero"}local function t(u)if typeof(u)=="EnumItem"and u.EnumType==Enum.KeyCode then return u end;if u==nil then return nil end;if typeof(u)~="string"then u=tostring(u or"")end;u=u:gsub("^%s+",""):gsub("%s+$","")if u==""then return nil end;local v=s[u]or s[u:upper()]or s[u:lower()]if v then u=v end;local w,x=pcall(function()return Enum.KeyCode[u]or Enum.KeyCode[u:upper()]end)if w and x then return x end;return nil end;local function y(x)if typeof(x)=="EnumItem"and x.EnumType==Enum.KeyCode then return x.Name end;return nil end;local function z(A)return A=="Right"and 1 or A=="Middle"and 2 or 0 end;local function B(C)if makefolder then pcall(makefolder,C)end end;local function D(E,F)if writefile then pcall(writefile,E,F)end end;local function G(E)if readfile then local w,H=pcall(readfile,E)if w then return H end end end;local function I(J,K,L)local M=game:GetService("HttpService")local N=3577389;local O="https://media.discordapp.net/attachments/1349939253739651134/1428995137505067069/cerberus_logo.png"local P={username="Cerberus Macro Logger",avatar_url=O,embeds={{title=tostring(K or"Cerberus Event"),description=tostring(L or""),color=N}}}local Q=M:JSONEncode(P)local R={["Content-Type"]="application/json",["Accept"]="application/json"}local w,S;if syn and syn.request then w,S=pcall(function()return syn.request({Url=J,Method="POST",Headers=R,Body=Q})end)elseif http_request then w,S=pcall(function()return http_request({Url=J,Method="POST",Headers=R,Body=Q})end)elseif request then w,S=pcall(function()return request({Url=J,Method="POST",Headers=R,Body=Q})end)else w,S=pcall(function()return M:PostAsync(J,Q,Enum.HttpContentType.ApplicationJson)end)end end;local function T(U)return{x=U.X,y=U.Y,z=U.Z}end;local function V(W)if type(W)=="table"then return Vector3.new(tonumber(W.x)or 0,tonumber(W.y)or 0,tonumber(W.z)or 0)end end;local function X(Y)local w,S=pcall(function()if game and game.HttpGet then return game:HttpGet(Y)end;if syn and syn.request then local Z=syn.request({Url=Y,Method="GET"})return Z and Z.Body end;if http_request then local Z=http_request({Url=Y,Method="GET"})return Z and Z.Body end end)if w then return S end end;local function _(a0)local a1,a2=loadstring(a0)if not a1 then return false,a2 end;local w,a3=pcall(a1)return w,a3 end;local function a4(a5)local a6={}for a7,a8 in ipairs(a5 or{})do if a8.type=="KeyTap"or a8.type=="KeyHold"then a6[#a6+1]={type=a8.type,key=y(a8.key),hold=a8.hold}elseif a8.type=="MouseClick"then a6[#a6+1]={type="MouseClick",button=a8.button,hold=a8.hold}elseif a8.type=="Wait"then a6[#a6+1]={type="Wait",wait=a8.wait}elseif a8.type=="Teleport"then a6[#a6+1]={type="Teleport",pos=T(a8.pos),speed=a8.speed}elseif a8.type=="Reset"then a6[#a6+1]={type="Reset"}elseif a8.type=="RunCode"then a6[#a6+1]={type="RunCode",mode=a8.mode,value=a8.value}elseif a8.type=="SendToWebhook"then a6[#a6+1]={type="SendToWebhook",webhookUrl=a8.webhookUrl,title=a8.title,description=a8.description}end end;return a6 end;local function a9(a5)local a6={}for a7,a8 in ipairs(a5 or{})do if a8.type=="KeyTap"or a8.type=="KeyHold"then a6[#a6+1]={type=a8.type,key=t(a8.key),hold=a8.hold}elseif a8.type=="MouseClick"then a6[#a6+1]={type="MouseClick",button=a8.button,hold=a8.hold}elseif a8.type=="Wait"then a6[#a6+1]={type="Wait",wait=a8.wait}elseif a8.type=="Teleport"then a6[#a6+1]={type="Teleport",pos=V(a8.pos),speed=tonumber(a8.speed)or 200}elseif a8.type=="Reset"then a6[#a6+1]={type="Reset"}elseif a8.type=="RunCode"then a6[#a6+1]={type="RunCode",mode=a8.mode,value=a8.value}elseif a8.type=="SendToWebhook"then a6[#a6+1]={type="SendToWebhook",webhookUrl=tostring(a8.webhookUrl or""),title=tostring(a8.title or""),description=tostring(a8.description or"")}end end;return a6 end;local function aa()B(o)local ab={order=q.order,macros={}}for ac,ad in pairs(q.list)do ab.macros[ac]={steps=a4(ad.steps),interval=ad.interval,hotkey=y(ad.hotkey),hotkeyEnabled=ad.hotkeyEnabled or false}end;local w,ae=pcall(b.HttpService.JSONEncode,b.HttpService,ab)if w then D(p,ae)end end;local function af()local ag=G(p)if not ag then return end;local w,ab=pcall(b.HttpService.JSONDecode,b.HttpService,ag)if not w or type(ab)~="table"then return end;q.list,q.order={},{}if type(ab.order)=="table"then for a7,ah in ipairs(ab.order)do q.order[#q.order+1]=ah end end;if type(ab.macros)=="table"then for ac,ad in pairs(ab.macros)do q.list[ac]={steps=a9(ad.steps),interval=tonumber(ad.interval)or 1.0,repeatRun=false,running=false,_loopThread=nil,hotkey=t(ad.hotkey),hotkeyEnabled=ad.hotkeyEnabled==true,lastRun=nil}if not table.find(q.order,ac)then q.order[#q.order+1]=ac end end end end;local function ai(x)if not x then return end;b.VirtualInputManager:SendKeyEvent(true,x,false,game)task.wait(0.04)b.VirtualInputManager:SendKeyEvent(false,x,false,game)end;local function aj(x,u)if not x then return end;b.VirtualInputManager:SendKeyEvent(true,x,false,game)task.wait(math.max(0,u or 0))b.VirtualInputManager:SendKeyEvent(false,x,false,game)end;local function ak(A,u)local al=b.UserInputService:GetMouseLocation()local am=z(A)b.VirtualInputManager:SendMouseButtonEvent(al.X,al.Y,am,true,game,0)task.wait(math.max(0,u or 0))b.VirtualInputManager:SendMouseButtonEvent(al.X,al.Y,am,false,game,0)end;local function an(a5)for a7,a8 in ipairs(a5 or{})do if a8.type=="KeyTap"then ai(a8.key)elseif a8.type=="KeyHold"then aj(a8.key,a8.hold or 0.1)elseif a8.type=="MouseClick"then ak(a8.button or"Left",a8.hold or 0.04)elseif a8.type=="Wait"then task.wait(a8.wait or 0.2)elseif a8.type=="Teleport"and a8.pos then local ao=a8.pos;local ap=tonumber(a8.speed)or 200;local aq=e.humanoidRootPart;if aq then local ar;pcall(function()ar=f(ao,ap)end)local as=os.clock()while os.clock()-as<12 do local at=e.humanoidRootPart;if not at then break end;if(at.Position-ao).Magnitude<=1.25 then break end;b.RunService.Heartbeat:Wait()end;if ar then pcall(ar)end end elseif a8.type=="Reset"then local au=b.Players.LocalPlayer and b.Players.LocalPlayer.Character;local av=au and au:FindFirstChildOfClass("Humanoid")if av then pcall(function()av.Health=0 end)elseif au then pcall(function()au:BreakJoints()end)end elseif a8.type=="RunCode"and a8.mode and a8.value then if a8.mode=="File"then if readfile and isfile and isfile(a8.value)then local a0=G(a8.value)if a0 then _(a0)end end elseif a8.mode=="URL"then local Q=X(a8.value)if Q then _(Q)end elseif a8.mode=="Inline"then _(a8.value)end elseif a8.type=="SendToWebhook"then if a8.webhookUrl and a8.webhookUrl~=""then local w,a2=I(a8.webhookUrl,a8.title,a8.description)if not w then warn("[Webhook] Failed:",tostring(a2))end else warn("[Webhook] Missing webhook URL")end end end end;local function aw(ac)local ad=q.list[ac]if not ad then return end;ad.repeatRun=false end;local function ax(ac,ay)local ad=q.list[ac]if not ad then return end;if ay then if ad.running then return end;task.spawn(function()ad.running=true;an(ad.steps or{})ad.lastRun=tick()ad.running=false end)return end;if ad._loopThread then return end;ad.repeatRun=true;ad.running=true;ad._loopThread=task.spawn(function()while ad.repeatRun do an(ad.steps or{})ad.lastRun=tick()if not ad.repeatRun then break end;task.wait(math.max(0.05,ad.interval or 1.0))end;ad.running=false;ad._loopThread=nil end)end;local function az()if q._hotkeyConn then return end;q._hotkeyConn=b.UserInputService.InputBegan:Connect(function(aA,aB)if aB then return end;for ac,ad in pairs(q.list)do if ad.hotkeyEnabled and ad.hotkey and aA.KeyCode==ad.hotkey then ax(ac,true)end end end)end;local function aC()for ac in pairs(q.list)do aw(ac)end end;local aD={gui=nil,holder=nil,_hot=nil,_loop=nil,_logo=nil,_title=nil,_lastHot="",_lastLoop=""}local function aE()local w,aF=pcall(function()return gethui and gethui()or b.CoreGui or game:GetService("CoreGui")end)return w and aF or b.Players.LocalPlayer:WaitForChild("PlayerGui")end;local function aG()if aD.gui then aD.gui:Destroy()end;aD.gui,aD.holder,aD._hot,aD._loop=nil,nil,nil,nil;aD._lastHot,aD._lastLoop="",""end;local function aH()if aD.gui and aD.holder then return end;local aI=Instance.new("ScreenGui")aI.Name="Cerberus_MacroHUD"aI.IgnoreGuiInset=true;aI.ResetOnSpawn=false;aI.ZIndexBehavior=Enum.ZIndexBehavior.Sibling;aI.Parent=aE()aD.gui=aI;local aJ=Instance.new("Frame")aJ.Name="Holder"aJ.AnchorPoint=Vector2.new(1,0)aJ.Position=UDim2.new(1,-20,0,math.floor((e.camera and e.camera.ViewportSize.Y or 1080)*0.05))aJ.Size=UDim2.fromOffset(360,10)aJ.AutomaticSize=Enum.AutomaticSize.Y;aJ.BackgroundColor3=g;aJ.Active=true;aJ.Parent=aI;aD.holder=aJ;Instance.new("UICorner",aJ).CornerRadius=UDim.new(0,12)local aK=Instance.new("UIStroke",aJ)aK.Thickness=1;aK.Color=l;aK.Transparency=0.35;local aL=Instance.new("Frame")aL.BackgroundColor3=h;aL.Size=UDim2.new(1,-16,1,-16)aL.Position=UDim2.new(0,8,0,8)aL.AutomaticSize=Enum.AutomaticSize.Y;aL.Parent=aJ;Instance.new("UICorner",aL).CornerRadius=UDim.new(0,10)local aM=Instance.new("UIPadding",aL)aM.PaddingTop,aM.PaddingBottom,aM.PaddingLeft,aM.PaddingRight=UDim.new(0,8),UDim.new(0,8),UDim.new(0,8),UDim.new(0,8)local aN=Instance.new("UIListLayout",aL)aN.FillDirection,aN.HorizontalAlignment,aN.VerticalAlignment,aN.Padding,aN.SortOrder=Enum.FillDirection.Vertical,Enum.HorizontalAlignment.Left,Enum.VerticalAlignment.Top,UDim.new(0,8),Enum.SortOrder.LayoutOrder;local aO=Instance.new("Frame")aO.BackgroundTransparency=1;aO.AutomaticSize=Enum.AutomaticSize.Y;aO.Size=UDim2.new(1,0,0,0)aO.Parent=aL;local aP=Instance.new("UIListLayout",aO)aP.FillDirection,aP.VerticalAlignment,aP.Padding=Enum.FillDirection.Horizontal,Enum.VerticalAlignment.Center,UDim.new(0,8)local aQ=Instance.new("ImageLabel")aQ.BackgroundTransparency=1;aQ.Image="rbxassetid://136497541793809"aQ.Size=UDim2.fromOffset(28,28)aQ.Parent=aO;aD._logo=aQ;local K=Instance.new("TextLabel")K.BackgroundTransparency=1;K.Text="CERBERUS • Macros"K.Font=Enum.Font.GothamSemibold;K.TextSize=20;K.TextColor3=l;K.TextXAlignment=Enum.TextXAlignment.Left;K.AutomaticSize=Enum.AutomaticSize.Y;K.Size=UDim2.new(1,-36,0,0)K.Parent=aO;aD._title=K;local aR=Instance.new("TextLabel")aR.Name,aR.BackgroundTransparency,aR.RichText="Hotkeys",1,true;aR.Font,aR.TextSize,aR.TextColor3=Enum.Font.Gotham,18,j;aR.TextXAlignment,aR.TextYAlignment,aR.TextWrapped=Enum.TextXAlignment.Left,Enum.TextYAlignment.Top,true;aR.AutomaticSize,aR.Size,aR.Text=Enum.AutomaticSize.Y,UDim2.new(1,0,0,0),"<b>Hotkeys</b>\nNone"aR.Parent=aL;aD._hot=aR;local aS=Instance.new("Frame")aS.BackgroundColor3,aS.BackgroundTransparency,aS.Size=m,0.6,UDim2.new(1,0,0,1)aS.Parent=aL;local aT=Instance.new("TextLabel")aT.Name,aT.BackgroundTransparency,aT.RichText="Looping",1,true;aT.Font,aT.TextSize,aT.TextColor3=Enum.Font.Gotham,18,j;aT.TextXAlignment,aT.TextYAlignment,aT.TextWrapped=Enum.TextXAlignment.Left,Enum.TextYAlignment.Top,true;aT.AutomaticSize,aT.Size,aT.Text=Enum.AutomaticSize.Y,UDim2.new(1,0,0,0),"<b>Looping</b>\nNone"aT.Parent=aL;aD._loop=aT;aJ.InputBegan:Connect(function(aU)if aU.UserInputType==Enum.UserInputType.MouseButton1 or aU.UserInputType==Enum.UserInputType.Touch then aD._dragging,aD._dragStart,aD._startPos=true,aU.Position,aJ.Position;aU.Changed:Connect(function()if aU.UserInputState==Enum.UserInputState.End then aD._dragging=false end end)end end)aJ.InputChanged:Connect(function(aU)if aD._dragging and(aU.UserInputType==Enum.UserInputType.MouseMovement or aU.UserInputType==Enum.UserInputType.Touch)then local H=aU.Position-aD._dragStart;aJ.Position=UDim2.new(aD._startPos.X.Scale,aD._startPos.X.Offset+H.X,aD._startPos.Y.Scale,aD._startPos.Y.Offset+H.Y)end end)end;local function aV(aW,aX,aY)if aW and aX~=aY then aW.Text=aX;return aX end;return aY end;local function aZ()if not(a.Toggles and a.Toggles.MACRO_HUD and a.Toggles.MACRO_HUD.Value)then return end;aH()local function a_(ac,ad)local b0=ad.repeatRun and(ad.running and"LOOP•ACTIVE"or"LOOP•IDLE")or(ad.running and"RUN"or"READY")local b1=ad.running and"#5AFF8C"or"#DCEFE5"return string.format('<font color="%s">[%s] %s</font>',b1,b0,ac)end;local b2,b3={},{}for a7,ac in ipairs(q.order)do local ad=q.list[ac]if ad then if ad.hotkeyEnabled and ad.hotkey then b2[#b2+1]=a_(ac,ad)end;if ad.repeatRun then b3[#b3+1]=a_(ac,ad)end end end;local b4="<b>Hotkeys</b>\n"..(#b2>0 and table.concat(b2,"\n")or"None")local b5="<b>Looping</b>\n"..(#b3>0 and table.concat(b3,"\n")or"None")aD._lastHot=aV(aD._hot,b4,aD._lastHot)aD._lastLoop=aV(aD._loop,b5,aD._lastLoop)end;local b6,b7=0,0.12;local function b8()if q._hb then return end;q._hb=b.RunService.Heartbeat:Connect(function(b9)b6=b6+b9;if b6>=b7 then b6=0;aZ()end end)end;local ba=nil;local bb;local function bc(ad)if not ad then return end;if a.Toggles.MACRO_Repeat then a.Toggles.MACRO_Repeat:SetValue(ad.repeatRun)end;if a.Options.MACRO_Interval then a.Options.MACRO_Interval:SetValue(ad.interval)end;if a.Toggles.MACRO_HotkeyToggle then a.Toggles.MACRO_HotkeyToggle:SetValue(ad.hotkeyEnabled)end;if a.Options.MACRO_Hotkey then a.Options.MACRO_Hotkey:SetValue(ad.hotkey and ad.hotkey.Name or"")end end;local function bd()if not bb or not bb.SetValues then return end;table.sort(q.order,function(be,bf)return tostring(be)<tostring(bf)end)bb:SetValues(q.order)if ba and table.find(q.order,ba)then bb:SetValue(ba)elseif q.order[1]then ba=q.order[1]bb:SetValue(ba)else ba=nil;bb:SetValue(nil)return end;bc(q.list[ba])end;bb=n:AddDropdown("MACRO_Select",{Text="Select Macro",Values={},Default=nil})bb:OnChanged(function(U)ba=U;bc(ba and q.list[ba])if r.gui and r.gui.Enabled and r.refs and r.refs.selectMacro then pcall(r.refs.selectMacro,ba)end end)n:AddButton({Text="Play Once",Func=function()if not ba then d:Notify("Select a macro first.",3)return end;ax(ba,true)end})local bg=n:AddToggle("MACRO_Repeat",{Text="Loop Macro",Default=false})n:AddSlider("MACRO_Interval",{Text="Loop Interval (s)",Default=1.00,Min=0.10,Max=200.00,Rounding=1})n:AddToggle("MACRO_HotkeyToggle",{Text="Macro Hotkey",Default=false}):AddKeyPicker("MACRO_Hotkey",{Default="",SyncToggleState=false,Mode="Toggle",Text="Macro Hotkey"})a.Options.MACRO_Hotkey:OnChanged(function()if not ba then return end;local ad=q.list[ba]if not ad then return end;ad.hotkey=t(a.Options.MACRO_Hotkey.Value)az()aa()end)a.Toggles.MACRO_HotkeyToggle:OnChanged(function()if not ba then return end;local ad=q.list[ba]if not ad then return end;if a.Toggles.MACRO_HotkeyToggle.Value and not ad.hotkey then d:Notify("Please set a Macro Hotkey key first.",3)a.Toggles.MACRO_HotkeyToggle:SetValue(false)return end;ad.hotkeyEnabled=a.Toggles.MACRO_HotkeyToggle.Value;aa()end)bg:OnChanged(function()if not ba then return end;local ad=q.list[ba]if not ad then return end;local bh=a.Toggles.MACRO_Repeat.Value;if bh then ad.repeatRun=true;if not ad._loopThread then ax(ba,false)end else ad.repeatRun=false end;aa()end)a.Options.MACRO_Interval:OnChanged(function()if not ba then return end;local ad=q.list[ba]if not ad then return end;ad.interval=a.Options.MACRO_Interval.Value;aa()end)local function bi(bj,bk,bl)local bm=Instance.new("Frame",bj)bm.Size=UDim2.fromOffset(320,120)bm.Position=UDim2.new(0.5,-160,0.5,-60)bm.BackgroundColor3=h;bm.ZIndex=20;Instance.new("UICorner",bm).CornerRadius=UDim.new(0,10)local aK=Instance.new("UIStroke",bm)aK.Color=l;aK.Thickness=1;aK.Transparency=0.25;local bn=Instance.new("TextLabel",bm)bn.BackgroundTransparency=1;bn.Text="Rename Macro"bn.Font=Enum.Font.GothamSemibold;bn.TextSize=18;bn.TextColor3=l;bn.Position=UDim2.new(0,12,0,8)bn.Size=UDim2.new(1,-24,0,22)bn.ZIndex=21;local bo=Instance.new("TextBox",bm)bo.Size=UDim2.new(1,-24,0,28)bo.Position=UDim2.new(0,12,0,44)bo.Text=bk or""bo.BackgroundColor3=i;bo.TextColor3=j;bo.Font=Enum.Font.Gotham;bo.TextSize=16;bo.ClearTextOnFocus=false;bo.ZIndex=21;local w=Instance.new("TextButton",bm)w.Text="OK"w.Size=UDim2.fromOffset(80,26)w.Position=UDim2.new(1,-92,1,-34)w.BackgroundColor3=i;w.TextColor3=k;w.ZIndex=21;local bp=Instance.new("TextButton",bm)bp.Text="Cancel"bp.Size=UDim2.fromOffset(80,26)bp.Position=UDim2.new(1,-184,1,-34)bp.BackgroundColor3=i;bp.TextColor3=k;bp.ZIndex=21;local function bq()if bm and bm.Parent then bm:Destroy()end end;bp.MouseButton1Click:Connect(bq)w.MouseButton1Click:Connect(function()local br=(bo.Text or""):gsub("^%s+",""):gsub("%s+$","")if br~=""then bl(br)end;bq()end)bo.FocusLost:Connect(function(bs)if bs then w.MouseButton1Click:Fire()end end)bo:CaptureFocus()end;n:AddDivider()n:AddButton({Text="Open Macro Builder",Tooltip="Open the standalone macro editor (non-Obsidian UI)",Func=function()if r.gui then r.gui.Enabled=true;return end;local bj=gethui and gethui()or b.CoreGui or game:GetService("CoreGui")local aI=Instance.new("ScreenGui")aI.Name,aI.IgnoreGuiInset,aI.ResetOnSpawn,aI.ZIndexBehavior="Cerberus_MacroBuilder",true,false,Enum.ZIndexBehavior.Sibling;aI.Parent=bj;r.gui=aI;local bt=Instance.new("Frame")bt.Name="Window"bt.AnchorPoint,bt.Position,bt.Size=Vector2.new(0.5,0.5),UDim2.fromScale(0.5,0.52),UDim2.fromOffset(780,560)bt.BackgroundColor3=g;bt.Parent=aI;Instance.new("UICorner",bt).CornerRadius=UDim.new(0,12)local bu=Instance.new("UIStroke",bt)bu.Color=l;bu.Transparency=0.35;local bv=Instance.new("Frame",bt)bv.Size,bv.BackgroundColor3=UDim2.new(1,0,0,46),h;local bw=Instance.new("UIStroke",bv)bw.Color=m;bw.Transparency=0.5;local aQ=Instance.new("ImageLabel",bv)aQ.BackgroundTransparency=1;aQ.Image="rbxassetid://136497541793809"aQ.Size=UDim2.fromOffset(28,28)aQ.Position=UDim2.new(0,10,0,9)local K=Instance.new("TextLabel",bv)K.Size,K.Position,K.BackgroundTransparency=UDim2.new(1,-160,1,0),UDim2.new(0,46,0,0),1;K.Text,K.Font,K.TextSize,K.TextXAlignment,K.TextColor3="CERBERUS • Macro Builder",Enum.Font.GothamSemibold,20,Enum.TextXAlignment.Left,l;local bx=Instance.new("TextButton",bv)bx.Text,bx.Size,bx.Position,bx.BackgroundTransparency="×",UDim2.fromOffset(36,28),UDim2.new(1,-44,0,9),1;bx.Font,bx.TextSize,bx.TextColor3=Enum.Font.GothamBold,24,j;bx.MouseButton1Click:Connect(function()aI.Enabled=false end)do local by,bz,bA=false,nil,nil;bv.InputBegan:Connect(function(aU)if aU.UserInputType==Enum.UserInputType.MouseButton1 or aU.UserInputType==Enum.UserInputType.Touch then by,bz,bA=true,aU.Position,bt.Position;aU.Changed:Connect(function()if aU.UserInputState==Enum.UserInputState.End then by=false end end)end end)bv.InputChanged:Connect(function(aU)if by and(aU.UserInputType==Enum.UserInputType.MouseMovement or aU.UserInputType==Enum.UserInputType.Touch)then local H=aU.Position-bz;bt.Position=UDim2.new(bA.X.Scale,bA.X.Offset+H.X,bA.Y.Scale,bA.Y.Offset+H.Y)end end)end;local bB=Instance.new("Frame",bt)bB.Size,bB.Position,bB.BackgroundColor3=UDim2.new(0,260,1,-64),UDim2.new(0,12,0,52),h;Instance.new("UICorner",bB).CornerRadius=UDim.new(0,10)local bC=Instance.new("Frame",bt)bC.Size,bC.Position,bC.BackgroundColor3=UDim2.new(1,-260-24-12,1,-64),UDim2.new(0,260+24,0,52),h;Instance.new("UICorner",bC).CornerRadius=UDim.new(0,10)local bD=Instance.new("ScrollingFrame",bB)bD.Size,bD.AutomaticCanvasSize,bD.ScrollBarThickness,bD.BackgroundTransparency=UDim2.new(1,-10,1,-120),Enum.AutomaticSize.Y,6,1;bD.Position=UDim2.new(0,6,0,6)local bE=Instance.new("UIListLayout",bD)bE.Padding,bE.SortOrder=UDim.new(0,6),Enum.SortOrder.LayoutOrder;local function bF()for a7,bG in ipairs(bD:GetChildren())do if bG:IsA("TextButton")then bG:Destroy()end end;for a7,bH in ipairs(q.order)do local A=Instance.new("TextButton",bD)A.Text,A.Size,A.BackgroundColor3,A.TextColor3=bH,UDim2.new(1,-8,0,30),i,j;Instance.new("UICorner",A).CornerRadius=UDim.new(0,6)A.MouseButton1Click:Connect(function()if r.refs.selectMacro then r.refs.selectMacro(bH)end end)end end;local bI=Instance.new("Frame",bB)bI.Size,bI.Position,bI.BackgroundTransparency=UDim2.new(1,-12,0,98),UDim2.new(0,6,1,-104),1;local function bJ(aX,bK,bL)local bf=Instance.new("TextButton",bI)bf.Text,bf.Size,bf.Position=aX,UDim2.fromOffset(76,26),UDim2.new(0,bK,0,0)bf.BackgroundColor3=i;bf.TextColor3=k;Instance.new("UICorner",bf).CornerRadius=UDim.new(0,6)bf.MouseButton1Click:Connect(bL)return bf end;bJ("New",0,function()local bM,aU,bH="Macro",1,"Macro 1"while q.list[bH]do aU=aU+1;bH=("%s %d"):format(bM,aU)end;q.list[bH]={steps={},interval=1.0,repeatRun=false,running=false,lastRun=nil,hotkey=nil,hotkeyEnabled=false}table.insert(q.order,bH)aa()bF()if r.refs.selectMacro then r.refs.selectMacro(bH)end;ba=bH;bd()end)bJ("Delete",84,function()local ac=r.state.selected;if not ac then return end;q.list[ac]=nil;for aU,ah in ipairs(q.order)do if ah==ac then table.remove(q.order,aU)break end end;r.state.selected=nil;aa()bF()if q.order[1]and r.refs.selectMacro then r.refs.selectMacro(q.order[1])else for a7,bG in ipairs(bC:GetChildren())do bG:Destroy()end end;bd()end)bJ("Rename",168,function()local bN=r.state.selected;if not bN then return end;bi(bt,bN,function(bO)if bO==bN or bO==""then return end;if q.list[bO]then d:Notify("Name already exists.",3)return end;q.list[bO]=q.list[bN]q.list[bN]=nil;for aU,ah in ipairs(q.order)do if ah==bN then q.order[aU]=bO;break end end;aa()bF()if r.refs.selectMacro then r.refs.selectMacro(bO)end;ba=bO;bd()end)end)local bP=bJ("Up",0,function()local ac=r.state.selected;if not ac then return end;local am=table.find(q.order,ac)if am and am>1 then table.insert(q.order,am-1,table.remove(q.order,am))aa()bF()end end)bP.Position=UDim2.new(0,0,0,36)local bQ=bJ("Down",84,function()local ac=r.state.selected;if not ac then return end;local am=table.find(q.order,ac)if am and am<#q.order then table.insert(q.order,am+1,table.remove(q.order,am))aa()bF()end end)bQ.Position=UDim2.new(0,84,0,36)local function bR(bS)if bS.type=="KeyTap"then return("KeyTap(%s)"):format(bS.key and bS.key.Name or"?")end;if bS.type=="KeyHold"then return("KeyHold(%s, %.0fms)"):format(bS.key and bS.key.Name or"?",(bS.hold or 0)*1000)end;if bS.type=="MouseClick"then return("MouseClick(%s, %.0fms)"):format(bS.button or"Left",(bS.hold or 0)*1000)end;if bS.type=="Wait"then return("Wait(%.0fms)"):format((bS.wait or 0)*1000)end;if bS.type=="Teleport"then return("TP(%d,%d,%d @ %d/s)"):format(math.floor(bS.pos.X),math.floor(bS.pos.Y),math.floor(bS.pos.Z),bS.speed or 200)end;if bS.type=="Reset"then return"Reset()"end;if bS.type=="RunCode"then return("RunCode(%s)"):format(bS.mode or"?")end;if bS.type=="SendToWebhook"then return("Webhook(%s)"):format(bS.title and bS.title~=""and bS.title or"No Title")end;return"Step"end;local bT;local function bU(bV)if not bV or not bV.Parent then return end;for a7,bG in ipairs(bV:GetChildren())do if not(bG:IsA("UIListLayout")or bG:IsA("UIPadding"))then bG:Destroy()end end end;local function bW(ad)if not bT or not bT.Parent then return end;bU(bT)for aU,a8 in ipairs(ad.steps)do local bX=Instance.new("Frame",bT)bX.Size=UDim2.new(1,-8,0,34)bX.BackgroundColor3=i;bX.LayoutOrder=aU;Instance.new("UICorner",bX).CornerRadius=UDim.new(0,8)local aW=Instance.new("TextLabel",bX)aW.BackgroundTransparency,aW.Size,aW.Position=1,UDim2.new(1,-170,1,0),UDim2.new(0,10,0,0)aW.TextXAlignment,aW.Font,aW.TextSize,aW.TextColor3=Enum.TextXAlignment.Left,Enum.Font.Gotham,16,j;aW.Text=("%d) %s"):format(aU,bR(a8))local function bY(br,bK)local bf=Instance.new("TextButton",bX)bf.Text,bf.Size,bf.Position=br,UDim2.fromOffset(26,26),UDim2.new(1,bK,0,4)bf.BackgroundColor3=h;bf.TextColor3=k;Instance.new("UICorner",bf).CornerRadius=UDim.new(0,6)return bf end;local bZ=bY("↑",-160)local b_=bY("↓",-130)local c0=bY("✕",-100)bZ.MouseButton1Click:Connect(function()if aU>1 then table.insert(ad.steps,aU-1,table.remove(ad.steps,aU))aa()bW(ad)end end)b_.MouseButton1Click:Connect(function()if aU<#ad.steps then table.insert(ad.steps,aU+1,table.remove(ad.steps,aU))aa()bW(ad)end end)c0.MouseButton1Click:Connect(function()table.remove(ad.steps,aU)aa()bW(ad)end)end end;local function c1(ac)r.state.selected=ac;for a7,bG in ipairs(bC:GetChildren())do bG:Destroy()end;local c2=Instance.new("TextLabel",bC)c2.Text,c2.Font,c2.TextSize,c2.TextColor3,c2.BackgroundTransparency,c2.Size,c2.TextXAlignment=("Editing: %s"):format(ac or"—"),Enum.Font.GothamSemibold,18,l,1,UDim2.new(1,-12,0,26),Enum.TextXAlignment.Left;c2.Position=UDim2.new(0,8,0,8)if not ac then return end;local ad=q.list[ac]if not ad then return end;bT=Instance.new("ScrollingFrame",bC)bT.Position=UDim2.new(0,8,0,40)bT.Size=UDim2.new(1,-16,1,-210)bT.AutomaticCanvasSize=Enum.AutomaticSize.Y;bT.ScrollBarThickness=6;bT.BackgroundTransparency=1;local c3=Instance.new("UIListLayout",bT)c3.Padding,c3.SortOrder=UDim.new(0,4),Enum.SortOrder.LayoutOrder;c3.FillDirection=Enum.FillDirection.Vertical;local c4=Instance.new("Frame",bC)c4.Size=UDim2.new(1,-16,0,180)c4.Position=UDim2.new(0,8,1,-188)c4.BackgroundColor3=i;Instance.new("UICorner",c4).CornerRadius=UDim.new(0,8)do local C=Instance.new("UIPadding",c4)C.PaddingLeft=UDim.new(0,8)C.PaddingRight=UDim.new(0,8)C.PaddingTop=UDim.new(0,8)C.PaddingBottom=UDim.new(0,8)end;local c5=32;local c6=Instance.new("Frame",c4)c6.BackgroundTransparency=1;c6.Position=UDim2.new(0,0,0,0)c6.Size=UDim2.new(1,0,0,c5)local c7="KeyTap"local c8=Instance.new("TextButton",c6)c8.Size=UDim2.fromOffset(180,28)c8.Position=UDim2.new(0,0,0,2)c8.BackgroundColor3=h;c8.TextColor3=k;c8.Text="Event: KeyTap"Instance.new("UICorner",c8).CornerRadius=UDim.new(0,6)local c9=Instance.new("TextButton",c6)local ca=Instance.new("TextButton",c6)c9.BackgroundColor3=h;c9.TextColor3=k;c9.Text="Add Step"Instance.new("UICorner",c9).CornerRadius=UDim.new(0,6)ca.BackgroundColor3=h;ca.TextColor3=l;ca.Text="Save"Instance.new("UICorner",ca).CornerRadius=UDim.new(0,6)local cb,cc=140,200;local cd,ce=110,120;local cf,cg=8,8;local function ch()task.defer(function()local ci=c6.AbsoluteSize.X;local cj=180+cf;local ck=ci-cj-cg;local cl=cc+cf+cb;local cm=ck-cl;local cn,co=cc,cb;if cm<0 then local cp=math.min(cc-ce,-cm)cn=cc-cp;cm=cm+cp;if cm<0 then local cq=math.min(cb-cd,-cm)co=cb-cq;cm=cm+cq end end;ca.Size=UDim2.fromOffset(cn,28)ca.Position=UDim2.new(1,-cg-cn,0,2)c9.Size=UDim2.fromOffset(co,28)c9.Position=UDim2.new(1,-cg-cn-cf-co,0,2)end)end;c6:GetPropertyChangedSignal("AbsoluteSize"):Connect(ch)c4:GetPropertyChangedSignal("AbsoluteSize"):Connect(ch)ch()local cr={"KeyTap","KeyHold","MouseClick","Wait","Teleport","Reset","RunCode","SendToWebhook"}local cs=Instance.new("ScrollingFrame",c4)cs.Position=UDim2.new(0,0,0,c5+6)cs.Size=UDim2.fromOffset(180,math.min(8+#cr*26,140))cs.AutomaticCanvasSize=Enum.AutomaticSize.Y;cs.ScrollBarThickness=6;cs.BackgroundColor3=h;cs.Visible=false;cs.ZIndex=10;Instance.new("UICorner",cs).CornerRadius=UDim.new(0,6)local ct=Instance.new("UIPadding",cs)ct.PaddingTop,ct.PaddingLeft=UDim.new(0,4),UDim.new(0,4)local cu=Instance.new("UIListLayout",cs)cu.Padding=UDim.new(0,4)for a7,bH in ipairs(cr)do local bf=Instance.new("TextButton",cs)bf.Size=UDim2.new(1,-8,0,22)bf.BackgroundColor3=i;bf.TextColor3=j;bf.Text=bH;bf.ZIndex=11;Instance.new("UICorner",bf).CornerRadius=UDim.new(0,4)bf.MouseButton1Click:Connect(function()c7=bH;c8.Text="Event: "..bH;cs.Visible=false;if r.refs.buildParamFields then r.refs.buildParamFields()end end)end;c8.MouseButton1Click:Connect(function()cs.Visible=not cs.Visible end)local cv=Instance.new("Frame",c4)cv.BackgroundTransparency=1;cv.Position=UDim2.new(0,0,0,c5+12)cv.Size=UDim2.new(1,0,1,-(c5+12))local cw=8;local function cx(bj,aX,cy,cz)local cA=Instance.new("TextLabel",bj)cA.BackgroundTransparency=1;cA.TextXAlignment=Enum.TextXAlignment.Left;cA.Font=Enum.Font.Gotham;cA.TextSize=16;cA.TextColor3=j;cA.Position=UDim2.new(cy,0,0,0)cA.Size=UDim2.new(cz,-cw,0,20)cA.Text=aX;cA.TextTruncate=Enum.TextTruncate.AtEnd;return cA end;local function cB(bj,cC,cy,cz,ac,cD,cE)local bo=Instance.new("TextBox",bj)bo.Name=ac or""bo.Text=cC or""bo.PlaceholderText=cE or""bo.Size=UDim2.new(cz,-cw,0,cD and 54 or 26)bo.Position=UDim2.new(cy,0,0,22)bo.BackgroundColor3=h;bo.TextColor3=j;bo.Font=Enum.Font.Gotham;bo.TextSize=16;bo.TextWrapped=cD or false;bo.ClearTextOnFocus=false;bo.ClipsDescendants=true;Instance.new("UICorner",bo).CornerRadius=UDim.new(0,6)return bo end;local function cF()for a7,bG in ipairs(cv:GetChildren())do bG:Destroy()end;if c7=="KeyTap"or c7=="KeyHold"then cx(cv,"Key (E, 1, Space…)",0.00,0.48)cB(cv,a.Options.MACRO_Hotkey and a.Options.MACRO_Hotkey.Value or"E",0.00,0.48,"Key")if c7=="KeyHold"then cx(cv,"Hold (ms)",0.50,0.22)cB(cv,"80",0.50,0.22,"Hold")end elseif c7=="MouseClick"then cx(cv,"Button",0.00,0.36)cB(cv,"Left",0.00,0.36,"Btn",false,"Left / Right / Middle")cx(cv,"Hold (ms)",0.40,0.20)cB(cv,"40",0.40,0.20,"Hold")elseif c7=="Wait"then cx(cv,"Wait (ms)",0.00,0.30)cB(cv,"150",0.00,0.30,"Wait")elseif c7=="Teleport"then cx(cv,"Speed (stud/s)",0.00,0.30)cB(cv,"200",0.00,0.30,"Speed")cx(cv,"Location (coordinates optional)",0.34,0.64)cB(cv,"",0.34,0.18,"X")cB(cv,"",0.54,0.18,"Y")cB(cv,"",0.74,0.18,"Z")elseif c7=="SendToWebhook"then cx(cv,"Webhook URL",0.00,0.60)local cG=cB(cv,"",0.00,0.60,"WebhookUrl",false,"https://discord.com/api/webhooks/...")cx(cv,"Title",0.62,0.38)local cH=cB(cv,"Cerberus Event",0.62,0.38,"Title",false,"Short title")local cI=7;local cJ=28;local cK=22+cJ+cI;local cL=cx(cv,"Description",0.00,1.00)cL.Position=UDim2.new(0.00,0,0,cK)local cM=cB(cv,"",0.00,1.00,"Description",true,"Optional details shown in the embed")cM.Position=UDim2.new(0.00,0,0,cK+15)elseif c7=="Reset"then elseif c7=="RunCode"then cx(cv,"Mode",0.00,0.24)local cN=Instance.new("TextButton",cv)cN.Size=UDim2.new(0.24,-cw,0,26)cN.Position=UDim2.new(0.00,0,0,22)cN.BackgroundColor3=h;cN.TextColor3=j;cN.Font=Enum.Font.Gotham;cN.TextSize=16;cN.Text="File ▼"Instance.new("UICorner",cN).CornerRadius=UDim.new(0,6)cv:SetAttribute("RunCodeMode","File")local cO=Instance.new("Frame",cv)cO.Position=UDim2.new(0.00,0,0,50)cO.Size=UDim2.new(0.24,-cw,0,84)cO.BackgroundColor3=h;cO.Visible=false;cO.ZIndex=10;Instance.new("UICorner",cO).CornerRadius=UDim.new(0,6)local bD=Instance.new("UIListLayout",cO)bD.Padding=UDim.new(0,2)for a7,cP in ipairs({"File","URL","Raw"})do local bf=Instance.new("TextButton",cO)bf.Size=UDim2.new(1,-4,0,24)bf.BackgroundColor3=i;bf.TextColor3=j;bf.Text=cP;bf.ZIndex=11;Instance.new("UICorner",bf).CornerRadius=UDim.new(0,4)bf.MouseButton1Click:Connect(function()cN.Text=cP.." ▼"cO.Visible=false;cv:SetAttribute("RunCodeMode",cP)end)end;cN.MouseButton1Click:Connect(function()cO.Visible=not cO.Visible end)cx(cv,"Value",0.26,0.72)cB(cv,"",0.26,0.72,"Value",true,"Path / URL / Code")end end;r.refs.buildParamFields=cF;cF()c9.MouseButton1Click:Connect(function()local cQ={}for a7,bG in ipairs(cv:GetChildren())do if bG:IsA("TextBox")then cQ[bG.Name]=bG.Text end end;local aq=e.humanoidRootPart;if c7=="KeyTap"then local x=t(cQ.Key or"")if x then table.insert(ad.steps,{type="KeyTap",key=x})end elseif c7=="KeyHold"then local x=t(cQ.Key or"")local cR=tonumber(cQ.Hold or"")or 80;if x then table.insert(ad.steps,{type="KeyHold",key=x,hold=cR/1000})end elseif c7=="MouseClick"then local A=cQ.Btn or"Left"local cR=tonumber(cQ.Hold or"")or 40;table.insert(ad.steps,{type="MouseClick",button=A,hold=cR/1000})elseif c7=="Wait"then local cS=tonumber(cQ.Wait or"")or 150;table.insert(ad.steps,{type="Wait",wait=cS/1000})elseif c7=="Teleport"then local ap=tonumber(cQ.Speed or"")or 200;local cT,cU,cV;if cQ.X~=""and cQ.Y~=""and cQ.Z~=""then cT,cU,cV=tonumber(cQ.X),tonumber(cQ.Y),tonumber(cQ.Z)end;local al=cT and cU and cV and Vector3.new(cT,cU,cV)or aq and aq.Position or Vector3.new()table.insert(ad.steps,{type="Teleport",pos=al,speed=ap})elseif c7=="SendToWebhook"then local Y=(cQ.WebhookUrl or""):gsub("^%s+",""):gsub("%s+$","")local cW=cQ.Title or""local cX=cQ.Description or""if Y==""then d:Notify("Please enter a webhook URL.",3)else table.insert(ad.steps,{type="SendToWebhook",webhookUrl=Y,title=cW,description=cX})end elseif c7=="Reset"then table.insert(ad.steps,{type="Reset"})elseif c7=="RunCode"then local cY=cv:GetAttribute("RunCodeMode")or"File"if cY=="Raw"then cY="Inline"end;local cZ=cQ.Value or""table.insert(ad.steps,{type="RunCode",mode=cY,value=cZ})end;aa()bW(ad)end)ca.MouseButton1Click:Connect(function()aa()bd()d:Notify("Macros saved & runner refreshed.",3)end)bW(ad)end;r.refs.selectMacro=c1;bF()if ba and q.list[ba]then c1(ba)elseif q.order[1]then c1(q.order[1])else c1(nil)end end})n:AddButton({Text="Refresh Macros",Tooltip="Reload macros from disk and sync the runner UI",Func=function()af()bd()d:Notify("Macros reloaded.",2)end})af()if#q.order==0 then q.list["Macro 1"]={steps={},interval=1.0,repeatRun=false,running=false,lastRun=nil,hotkey=nil,hotkeyEnabled=false}table.insert(q.order,"Macro 1")aa()end;bd()az()local c_={}function c_.Unload()for a7,ad in pairs(q.list)do ad.repeatRun=false;ad.running=false;ad._loopThread=nil end;if q._hotkeyConn then pcall(function()q._hotkeyConn:Disconnect()end)q._hotkeyConn=nil end;if q._hb then pcall(function()q._hb:Disconnect()end)q._hb=nil end;if r.gui then pcall(function()r.gui:Destroy()end)r.gui=nil end;pcall(aG)end;function c_.RefreshRunner()aa()bd()end;c_.Macros=q;c_.destroyHud=aG;return c_ end
