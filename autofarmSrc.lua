return function(a)local b,c,d,e,f,g=a.Services,a.Tabs,a.References,a.Library,a.Options,a.Toggles;local h,i,j=a.MoveToPos,a.PREFIX or"NH_",a.Config or{}local k=j.TargetAPI or{}local l=j.DodgeConfig or{}local m=j.AutoYOffsetConfig or{}local n=j.TargetTypes or{Players={key="Players"},Entities={key="Entities"}}local o=j.Defaults or{mode="Aligned",yOffset=10,horizDist=4,targetType="Players"}local p=j.UIText or{groupTitle="AutoFarm",statusTitle="AutoFarm Status"}local q=j.Move or{approachMaxSecs=12,reachDistance=3,moveForceResp=80,moveMaxVelocity=120,orientResp=120,approachSpeed=1000}local r=j.Perf or{scanCooldown=0.5,waitScanHz=4,statusHz=5}local s=j.Overrides or{}local t=j.ServerHop or{}local u=function(v,w)if e and e.Notify then e:Notify(v,w or 3)end end;local function x(y,z)return type(y)=="function"and y or z end;local A=x(k.hrpOf,function(B)if not B then return end;if B:IsA("Player")then local C=B.Character;return C and(C:FindFirstChild("HumanoidRootPart")or C:FindFirstChildWhichIsA("BasePart"))end;if B:IsA("Model")then return B:FindFirstChild("HumanoidRootPart")or B:FindFirstChildWhichIsA("BasePart")end;return B:IsA("BasePart")and B or nil end)local D=x(k.isAlive,function(E)if not(E and E.Parent)then return false end;local F=E:FindFirstChildOfClass("Humanoid")if F then return F.Health>0 end;if E:IsA("Player")then local C=E.Character;local G=C and C:FindFirstChildOfClass("Humanoid")return C and G and G.Health>0 end;return true end)local H=x(k.isValid,function(E,I)return D(E)and A(E)~=nil end)local J=x(k.getAdornee,function(E)if not E then return nil end;if E:IsA("Player")then return E.Character end;if E:IsA("Model")then return E end;return E end)local K={mode=o.mode,yOffset=o.yOffset,horizDist=o.horizDist,targetType=o.targetType,selectedTargets={},currentInst=nil,running=false,_phase="Idle",_hb=nil,_watchSelf=nil,_moveCleanup=nil,dodgeMode=o.dodgeMode,autoYOffset=o.autoYOffset,_dodgeActive=false,_dodgeConns={},_dodgeScanHB=nil,_dodgeRange=50,showStatus=o.showStatus,_statusHB=nil,_statusDiedConn=nil,_statusLastTarget=nil,_statusLastHealth=nil,_statusGui=nil,_statusBar=nil,_statusText=nil,_hoverAP=nil,_hoverAO=nil,_hoverA0=nil,_hoverA1=nil,_hoverNoclipHB=nil,_idleAnchor=nil,_instToLabel={},_labelToList={},overridesEnabled=false,overrideSelection={},activeOverride=nil,_overrideHB=nil,serverHopEnabled=false,_lastHopTime=0,_camGhostHB=nil,_camTouched={},_prevOcclusion=nil,_targetFX=nil}local function L(E)if not E then return"nil"end;if E:IsA("Player")then return E.DisplayName~=""and E.DisplayName or E.Name end;return E.Name end;local function M(N,O,P,Q)local R,S=N.LookVector,N.RightVector;local T=Vector3.new(0,Q,0)if O=="Behind"then return-R*P+T elseif O=="In Front"then return R*P+T elseif O=="Left"then return-S*P+T elseif O=="Right"then return S*P+T else return T end end;local function U(V)local W={}for X in string.gmatch(V or"","[^/]+")do W[#W+1]=X end;return W end;local function Y(Z,V)if not Z then return nil end;local W=U(V)if#W==0 then return nil end;local _=Z;if W[1]=="Workspace"then table.remove(W,1)end;for a0,X in ipairs(W)do _=_:FindFirstChild(X)if not _ then return nil end end;return _ end;local function a1(a2,a3)if not a3 then return true end;a2=tostring(a2 or"")local a4=a3.caseInsensitive;if a3.names then for a0,a5 in ipairs(a3.names)do if a4 then if string.lower(a2)==string.lower(a5)then return true end else if a2==a5 then return true end end end;return false end;if a3.patterns then for a0,a6 in ipairs(a3.patterns)do local a7=a4 and string.lower(a2)or a2;local a8=a4 and string.lower(a6)or a6;local a9,aa=pcall(string.find,a7,a8)if a9 and aa then return true end end;return false end;return true end;local function ab(ac,a3)if not a3 then return ac end;local ad={}for a5,ae in pairs(ac)do local af=true;if a3.include then af=a3.include[a5]==true end;if a3.exclude and a3.exclude[a5]then af=false end;if af then ad[a5]=ae end end;return ad end;local function ag(ac,ah,E)ac[ah]=ac[ah]or{}table.insert(ac[ah],E)end;local function ai()local aj={}for a0,V in ipairs(b.Players:GetPlayers())do if V~=d.player then aj[V.DisplayName~=""and V.DisplayName or V.Name]={V}end end;return aj end;local function ak()local aj={}for a0,al in ipairs(b.Workspace:GetDescendants())do if al:IsA("Model")and not b.Players:GetPlayerFromCharacter(al)then local F=al:FindFirstChildOfClass("Humanoid")if F then ag(aj,al.Name,al)end end end;return aj end;local function am(an,ao)ao=ao or{}local Z=Y(b.Workspace,an)local aj={}if not Z then return aj end;for a0,al in ipairs(Z:GetDescendants())do if ao.modelsOnly and al:IsA("Model")then if not ao.humanoidsOnly or al:FindFirstChildOfClass("Humanoid")then if a1(al.Name,ao)and(not ao.filter or ao.filter(al))then ag(aj,al.Name,al)end end elseif not ao.modelsOnly then if a1(al.Name,ao)and(not ao.filter or ao.filter(al))then ag(aj,al.Name,al)end end end;return aj end;local ap,aq={},tonumber(r.scanCooldown)or 0.5;local function ar(ah)local as=ap[ah]if as and os.clock()-as.t<aq then return as.res end end;local function at(ah,aj)ap[ah]={t=os.clock(),res=aj}end;local function au(av,a3)local aw=ar(av)if aw then return aw end;local aj={}if a3.getItems then local a9,ac=pcall(a3.getItems,b,d)aj=a9 and(ac or{})or{}elseif a3.folderPath then aj=am(a3.folderPath,a3)elseif a3.key=="Players"then aj=ai()elseif a3.key=="Entities"then local ax=ak()if a3.names or a3.patterns then local ay={}for a5,ae in pairs(ax)do if a1(a5,a3)then ay[a5]=ae end end;aj=ay else aj=ax end else aj={}end;aj=ab(aj,a3)K._labelToList,K._instToLabel=aj,{}for az,ae in pairs(aj)do for a0,E in ipairs(ae)do K._instToLabel[E]=az end end;at(av,aj)return aj end;local function aA(av)local a3=n[av]if not a3 then return{}end;return au(av,a3)end;local function aB(aC)local aD;for a0,V in ipairs(b.Players:GetPlayers())do if V~=d.player then local C=V.Character;local aE=C and C:FindFirstChild("HumanoidRootPart")if aE then local al=(aE.Position-aC).Magnitude;if not aD or al<aD then aD=al end end end end;return aD or math.huge end;local function aF(E)if not(g.AF_Safety and g.AF_Safety.Value)then return true end;local aG=A(E)if not aG then return false end;local aH=f.AF_SafetyRange and f.AF_SafetyRange.Value or 50;return aB(aG.Position)>aH end;local function aI()local ac=aA(K.targetType)local aJ={}for a0,a2 in ipairs(K.selectedTargets or{})do local ae=ac[a2]if ae then for a0,E in ipairs(ae)do if H(E,K)and aF(E)then aJ[#aJ+1]=E end end end end;return aJ end;local function aK(ae)local aE=d.humanoidRootPart;if not aE or not ae or#ae==0 then return end;local aD,aL;for a0,E in ipairs(ae)do local aM=A(E)if aM then local al=(aM.Position-aE.Position).Magnitude;if not aL or al<aL then aD,aL=E,al end end end;return aD end;local function aN()return aK(aI())end;local function aO()local aP={}for a2,a3 in pairs(s)do if K.overrideSelection[a2]then aP[#aP+1]={name=a2,def=a3,pr=tonumber(a3.priority)or 0}end end;table.sort(aP,function(aQ,aR)return aQ.pr>aR.pr end)return aP end;local function aS()if not K.running then return end;if K.currentInst and(not H(K.currentInst,K)or not aF(K.currentInst))then K.currentInst=nil end;local aT=aN()if aT then K.currentInst=aT;startApproach()else waitForEnemies()end end;local function aU()if K.activeOverride then local aV=K.activeOverride;K.activeOverride=nil;if K._overrideHB then pcall(function()K._overrideHB:Disconnect()end)end;K._overrideHB=nil;if aV.cleanup then pcall(aV.cleanup)end;if aV.def and aV.def.cancel then pcall(aV.def.cancel,b,d,a,K)end;aS()end end;local function aW()if not K.overridesEnabled or K.activeOverride then return false end;for a0,aX in ipairs(aO())do local a9,aY=pcall(function()return type(aX.def.shouldTrigger)=="function"and aX.def.shouldTrigger(b,d,a,K)or false end)if a9 and aY then local aZ;pcall(function()if type(aX.def.begin)=="function"then aZ=aX.def.begin(b,d,a,K)end end)K.activeOverride={name=aX.name,def=aX.def,cleanup=aZ,prevPhase=K._phase}K._overrideHB=b.RunService.Heartbeat:Connect(function(a_)if not K.activeOverride then return end;local aV=K.activeOverride;if type(aV.def.step)=="function"then pcall(aV.def.step,a_,b,d,a,K)end;local b0=false;if type(aV.def.isComplete)=="function"then local b1,al=pcall(aV.def.isComplete,b,d,a,K)b0=b1 and al==true end;if b0 then aU()end end)return true end end;return false end;local b2=setmetatable({},{__mode="k"})local b3={}local function b4()for F,b5 in pairs(b3)do if b5 then pcall(function()b5:Disconnect()end)end;b3[F]=nil end;b2=setmetatable({},{__mode="k"})end;local function b6()b4()if K._dodgeScanHB then pcall(function()K._dodgeScanHB:Disconnect()end)end;K._dodgeScanHB=nil;K._dodgeActive=false;if K._dodgeConns then for a0,as in ipairs(K._dodgeConns)do pcall(function()as:Disconnect()end)end end;K._dodgeConns={}end;local function b7(b8,w)if K._dodgeActive then return end;K._dodgeActive=true;local b9=K.yOffset;K.yOffset=b8;task.delay(w,function()if K._dodgeActive then K.yOffset=b9;K._dodgeActive=false end end)end;local function ba(E)local aE=d.humanoidRootPart;local aM=A(E)if not(aE and aM)then return false end;local S=K._dodgeRange or 50;return(aM.Position-aE.Position).Magnitude<=S end;local bb,bc;local function bd(F)if not F or b3[F]then return end;local be=b.Players:GetPlayerFromCharacter(F.Parent)~=nil;if be then return end;b3[F]=F.AnimationPlayed:Connect(function(bf)local bg=bf and bf.Animation;local bh=bg and bg.AnimationId or""local bi=tonumber(string.match(bh,"%d+"))if not bi then return end;local bj=l[bi]if not bj then return end;if not ba(F.Parent)then return end;local bk=tonumber(bj.delay)or 0;local bl=tonumber(bj.dodgeY)or K.yOffset;local bm=tonumber(bj.duration)or 0.5;task.delay(bk,function()if K.dodgeMode and ba(F.Parent)then b7(bl,bm)end end)end)end;local function bn()b6()if not K.dodgeMode then return end;for a0,al in ipairs(b.Workspace:GetDescendants())do if al:IsA("Humanoid")then b2[al]=true;bd(al)end end;bb=b.Workspace.DescendantAdded:Connect(function(al)if not K.dodgeMode then return end;if al:IsA("Humanoid")then b2[al]=true;bd(al)end end)bc=b.Workspace.DescendantRemoving:Connect(function(al)if al:IsA("Humanoid")then b2[al]=nil;local as=b3[al]if as then pcall(function()as:Disconnect()end)end;b3[al]=nil end end)table.insert(K._dodgeConns,bb)table.insert(K._dodgeConns,bc)end;local function bo(B)if K._dodgeActive then return end;if not(K.autoYOffset and B)then return end;local az=K._instToLabel[B]if not az then return end;for ah,bp in pairs(m)do if tostring(az):find(ah,1,true)then if type(bp)=="number"then K.yOffset=bp elseif type(bp)=="table"then if bp.y~=nil then K.yOffset=tonumber(bp.y)or K.yOffset end;if bp.mode and type(bp.mode)=="string"then K.mode=bp.mode end end;return end end end;local function bq()if K._statusGui then pcall(function()K._statusGui:Destroy()end)end;K._statusGui,K._statusBar,K._statusText=nil,nil,nil end;local function br()if K._statusGui and K._statusGui.Parent then return end;local bs=b.Players.LocalPlayer:FindFirstChildOfClass("PlayerGui")if not bs then return end;local bt=Instance.new("ScreenGui")bt.Name=i.."AF_Status"bt.ResetOnSpawn=false;bt.ZIndexBehavior=Enum.ZIndexBehavior.Sibling;bt.Parent=bs;local bu=Instance.new("Frame")bu.Name="Panel"bu.AnchorPoint=Vector2.new(0,0)bu.Position=UDim2.fromOffset(12,100)bu.Size=UDim2.fromOffset(240,62)bu.BackgroundColor3=Color3.fromRGB(18,18,18)bu.BackgroundTransparency=0.2;bu.BorderSizePixel=0;bu.Parent=bt;local bv=Instance.new("UICorner")bv.CornerRadius=UDim.new(0,10)bv.Parent=bu;local bw=Instance.new("TextLabel")bw.Name="Title"bw.Size=UDim2.new(1,-10,0,22)bw.Position=UDim2.fromOffset(8,6)bw.BackgroundTransparency=1;bw.Font=Enum.Font.GothamSemibold;bw.TextSize=14;bw.TextXAlignment=Enum.TextXAlignment.Left;bw.TextColor3=Color3.fromRGB(200,255,200)bw.Text=p.statusTitle or"AutoFarm Status"bw.Parent=bu;local bx=Instance.new("TextLabel")bx.Name="HPText"bx.Size=UDim2.new(1,-10,0,18)bx.Position=UDim2.fromOffset(8,28)bx.BackgroundTransparency=1;bx.Font=Enum.Font.Gotham;bx.TextSize=13;bx.TextXAlignment=Enum.TextXAlignment.Left;bx.TextColor3=Color3.fromRGB(230,230,230)bx.Text="Target: —  HP: —/—"bx.Parent=bu;local by=Instance.new("Frame")by.Name="BarBG"by.Size=UDim2.fromOffset(224,8)by.Position=UDim2.fromOffset(8,48)by.BackgroundColor3=Color3.fromRGB(45,45,45)by.BorderSizePixel=0;by.Parent=bu;local bz=Instance.new("UICorner")bz.CornerRadius=UDim.new(0,4)bz.Parent=by;local bA=Instance.new("Frame")bA.Name="Bar"bA.Size=UDim2.new(0,0,1,0)bA.BackgroundColor3=Color3.fromRGB(50,205,50)bA.BorderSizePixel=0;bA.Parent=by;local bB=Instance.new("UICorner")bB.CornerRadius=UDim.new(0,4)bB.Parent=bA;K._statusGui,K._statusBar,K._statusText=bt,bA,bx end;local function bC(B,bD,bE)if not(K._statusGui and K._statusGui.Parent)then return end;local aM,aR=K._statusText,K._statusBar;if not(aM and aR)then return end;local G,bF=tonumber(bD)or 0,tonumber(bE)or 0;local bG=bF>0 and math.clamp(G/bF,0,1)or 0;aM.Text=("Target: %s    HP: %d/%d"):format(B and L(B)or"—",G,bF)aR.Size=UDim2.new(bG,0,1,0)end;local function bH()if K._statusHB then pcall(function()K._statusHB:Disconnect()end)K._statusHB=nil end;if K._statusDiedConn then pcall(function()K._statusDiedConn:Disconnect()end)K._statusDiedConn=nil end;K._statusLastTarget,K._statusLastHealth=nil,nil;bq()end;local function bI(B)if not B then return end;if B:IsA("Player")then local C=B.Character;return C and C:FindFirstChildOfClass("Humanoid")end;if B:IsA("Model")then return B:FindFirstChildOfClass("Humanoid")end end;local function bJ(B)if K._statusDiedConn then pcall(function()K._statusDiedConn:Disconnect()end)K._statusDiedConn=nil end;local F=bI(B)if F then K._statusDiedConn=F.Died:Connect(function()local bK=aN()if bK and bK~=B then K.currentInst=bK;if K._phase~="Approach"and K.running then startApproach()end end end)end end;local function bL()bH()if not K.showStatus then return end;br()local bM,bN=0,1/math.max(1,tonumber(r.statusHz)or 5)K._statusHB=b.RunService.Heartbeat:Connect(function(a_)if not K.showStatus then return end;bM=bM+a_;if bM<bN then return end;bM=0;local bO=K.currentInst;if bO~=K._statusLastTarget then K._statusLastTarget,K._statusLastHealth=bO,nil;if bO then bJ(bO)end end;if not bO then bC(nil,0,0)return end;local F=bI(bO)if F then local bD,bF=math.floor(F.Health),math.floor(F.MaxHealth or 0)if bD~=K._statusLastHealth then K._statusLastHealth=bD;bC(bO,bD,bF)end else bC(bO,0,0)end end)end;local function bP()for a0,bQ in ipairs({K._hoverAP,K._hoverAO,K._hoverA0,K._hoverA1})do if bQ then pcall(function()bQ:Destroy()end)end end;K._hoverAP,K._hoverAO,K._hoverA0,K._hoverA1=nil,nil,nil,nil;if K._hoverNoclipHB then pcall(function()K._hoverNoclipHB:Disconnect()end)end;K._hoverNoclipHB=nil;if K._idleAnchor then pcall(function()K._idleAnchor:Destroy()end)end;K._idleAnchor=nil end;local function bR()local bS=d.character;if not bS then return end;for a0,al in ipairs(bS:GetDescendants())do if al:IsA("BasePart")then al.CanCollide=false end end end;local function bT()for aG,a0 in pairs(K._camTouched)do if aG and aG.Parent then pcall(function()aG.LocalTransparencyModifier=0 end)end end;K._camTouched={}end;local function bU()if K._camGhostHB then pcall(function()K._camGhostHB:Disconnect()end)end;K._camGhostHB=nil;bT()local bV=b.Players.LocalPlayer;if K._prevOcclusion~=nil then pcall(function()bV.DevCameraOcclusionMode=K._prevOcclusion end)end;K._prevOcclusion=nil end;local function bW()bU()local bX=workspace.CurrentCamera;local bV=b.Players.LocalPlayer;K._prevOcclusion=bV.DevCameraOcclusionMode;pcall(function()bV.DevCameraOcclusionMode=Enum.DevCameraOcclusionMode.Invisicam end)K._camGhostHB=b.RunService.RenderStepped:Connect(function()local bY=d.humanoidRootPart;if not(bX and bY)then bT()return end;local bZ=d.character and d.character:FindFirstChild("Head")local b_=bZ and bZ.Position or bY.Position;local c0={}if d.character then for a0,al in ipairs(d.character:GetDescendants())do if al:IsA("BasePart")then table.insert(c0,al)end end end;local W={}pcall(function()W=bX:GetPartsObscuringTarget({b_},c0)end)local c1={}for a0,aG in ipairs(W or{})do if aG and aG:IsA("BasePart")then c1[aG]=true;if not K._camTouched[aG]then K._camTouched[aG]=true;pcall(function()aG.LocalTransparencyModifier=0.75 end)end end end;for c2,a0 in pairs(K._camTouched)do if not c1[c2]then K._camTouched[c2]=nil;if c2 and c2.Parent then pcall(function()c2.LocalTransparencyModifier=0 end)end end end end)end;local function c3()if K._targetFX then pcall(function()K._targetFX:Destroy()end)end;K._targetFX=nil end;local function c4(B)local c5=J(B)if not c5 then c3()return end;if not K._targetFX or not K._targetFX.Parent then local G=Instance.new("Highlight")G.Name=i.."AF_TargetAura"G.FillTransparency=0.7;G.OutlineTransparency=0;G.FillColor=Color3.fromRGB(50,205,50)G.OutlineColor=Color3.fromRGB(20,80,20)G.DepthMode=Enum.HighlightDepthMode.AlwaysOnTop;G.Parent=b.CoreGui or b.Players.LocalPlayer:FindFirstChildOfClass("PlayerGui")K._targetFX=G end;K._targetFX.Adornee=c5 end;local function c6()bP()K._phase="IdleHover"local c7=d.humanoidRootPart;if not c7 then return end;if d.humanoid then d.humanoid.AutoRotate=false end;c7.AssemblyAngularVelocity=Vector3.zero;local c8=Instance.new("Part")c8.Name=i.."AF_IdleAnchor"c8.Size=Vector3.new(1,1,1)c8.CFrame=c7.CFrame+Vector3.new(0,K.yOffset,0)c8.Anchored=true;c8.Transparency=1;c8.CanCollide=false;c8.Parent=b.Workspace;K._idleAnchor=c8;local c9=Instance.new("Attachment")c9.Name=i.."AF_A0"c9.Parent=c7;local ca=Instance.new("Attachment")ca.Name=i.."AF_A1"ca.Parent=c8;local cb=Instance.new("AlignPosition")cb.Name=i.."AF_AP"cb.Mode=Enum.PositionAlignmentMode.TwoAttachment;cb.Attachment0=c9;cb.Attachment1=ca;cb.Responsiveness=q.moveForceResp or 80;cb.MaxVelocity=q.moveMaxVelocity or 120;cb.MaxForce=math.huge;cb.Parent=c7;local cc=Instance.new("AlignOrientation")cc.Name=i.."AF_AO"cc.Mode=Enum.OrientationAlignmentMode.OneAttachment;cc.Attachment0=c9;cc.Responsiveness=q.orientResp or 120;cc.MaxTorque=math.huge;cc.RigidityEnabled=true;cc.Parent=c7;K._hoverAP,K._hoverAO,K._hoverA0,K._hoverA1=cb,cc,c9,ca;bR()K._hoverNoclipHB=b.RunService.Stepped:Connect(bR)end;local function waitForEnemies()if K._hb then pcall(function()K._hb:Disconnect()end)K._hb=nil end;K._phase="Waiting"c6()c3()local bM,bN=0,1/math.max(1,tonumber(r.waitScanHz)or 4)K._hb=b.RunService.Heartbeat:Connect(function(a_)if not K.running then return end;if K.overridesEnabled and not K.activeOverride then pcall(aW)end;bM=bM+a_;if bM<bN then return end;bM=0;local bK=aN()if bK then K.currentInst=bK;startApproach()return end;if K.serverHopEnabled and type(t.hop)=="function"then local cd=os.clock()local ce=tonumber(t.cooldown)or 6;if cd-(K._lastHopTime or 0)>=ce then K._lastHopTime=cd;pcall(function()t.hop(b,d,a,K)end)end end end)end;function startApproach()if K._hb then pcall(function()K._hb:Disconnect()end)K._hb=nil end;bP()K._phase="Approach"local bO=K.currentInst;if not bO then local cf=aN()if not cf then waitForEnemies()return end;bO=cf;K.currentInst=cf end;bo(bO)if K.showStatus then bL()end;bn()c4(bO)local function cg()return not H(bO,K)or not aF(bO)end;local function ch()if cg()then return nil end;local aM=A(bO)if not aM then return nil end;return aM.Position+M(aM.CFrame,K.mode,K.horizDist,K.yOffset)end;local ci=ch()if not ci then waitForEnemies()return end;K._moveCleanup=h(ci,tonumber(q.approachSpeed)or 1000,ch)local cj=os.clock()K._hb=b.RunService.Heartbeat:Connect(function()if K._phase~="Approach"then return end;if K.overridesEnabled and not K.activeOverride then local ck,cl=pcall(aW)if ck and cl then if K._moveCleanup then pcall(K._moveCleanup)K._moveCleanup=nil end;return end end;local c7=d.humanoidRootPart;if not c7 then return end;c4(K.currentInst)local cm=ch()if not cm then local bK=aN()if bK then K.currentInst=bK;startApproach()else waitForEnemies()end;return end;if(c7.Position-cm).Magnitude<=(q.reachDistance or 3)then if K._moveCleanup then pcall(K._moveCleanup)K._moveCleanup=nil end;K._phase="Hover"task.defer(function()if K.running then task.wait(0.05)startHover()end end)return end;if os.clock()-cj>(q.approachMaxSecs or 12)then waitForEnemies()return end;if cg()then local bK=aN()if bK then K.currentInst,bO=bK,bK else waitForEnemies()end end end)end;function startHover()if K._hb then pcall(function()K._hb:Disconnect()end)K._hb=nil end;bP()K._phase="Hover"local c7,bO,cn=d.humanoidRootPart,K.currentInst,nil;if not(bO and H(bO,K)and aF(bO))then waitForEnemies()return end;cn=A(bO)if not(c7 and cn)then waitForEnemies()return end;if d.humanoid then d.humanoid.AutoRotate=false end;c7.AssemblyAngularVelocity=Vector3.zero;c4(bO)local c9=Instance.new("Attachment")c9.Name=i.."AF_HoverA0"c9.Parent=c7;local ca=Instance.new("Attachment")ca.Name=i.."AF_HoverA1"ca.Parent=cn;local cb=Instance.new("AlignPosition")cb.Name=i.."AF_HoverAP"cb.Mode=Enum.PositionAlignmentMode.TwoAttachment;cb.Attachment0=c9;cb.Attachment1=ca;cb.Responsiveness=q.moveForceResp or 80;cb.MaxVelocity=q.moveMaxVelocity or 120;cb.MaxForce=math.huge;cb.Parent=c7;local cc=Instance.new("AlignOrientation")cc.Name=i.."AF_HoverAO"cc.Mode=Enum.OrientationAlignmentMode.OneAttachment;cc.Attachment0=c9;cc.Responsiveness=q.orientResp or 120;cc.MaxTorque=math.huge;cc.RigidityEnabled=true;cc.Parent=c7;K._hoverAP,K._hoverAO,K._hoverA0,K._hoverA1=cb,cc,c9,ca;local function co()local cp=A(K.currentInst)if not cp then return end;if not K._dodgeActive then bo(K.currentInst)end;local N=cp.CFrame;local cq=M(N,K.mode,K.horizDist,K.yOffset)ca.Position=N:VectorToObjectSpace(cq)end;local function cr()local cs,ct,cp=K.currentInst,d.humanoidRootPart,A(K.currentInst)if not(cs and H(cs,K)and ct and cp and aF(cs))then waitForEnemies()return end;local cu,cv=ct.Position,cp.Position;local cw=cv-cu;local cx=cw.Magnitude;if cx<1e-6 then return end;cw=cw/cx;local T=Vector3.yAxis;if math.abs(cw:Dot(T))>0.98 then T=Vector3.xAxis end;local cy=CFrame.lookAt(cu,cv,T)K._hoverAO.CFrame=cy end;co()cr()bR()K._hoverNoclipHB=b.RunService.Stepped:Connect(bR)K._hb=b.RunService.RenderStepped:Connect(function()if not K.running then return end;if K.overridesEnabled and not K.activeOverride then local ck,cl=pcall(aW)if ck and cl then stopHover()return end end;co()cr()if not aF(K.currentInst)or not H(K.currentInst,K)then local bK=aN()if bK and bK~=K.currentInst then K.currentInst=bK;startApproach()else waitForEnemies()end end end)end;local function cz()if K._hb then pcall(function()K._hb:Disconnect()end)K._hb=nil end;if K._overrideHB then pcall(function()K._overrideHB:Disconnect()end)K._overrideHB=nil end end;local function stopHover()cz()bP()if d.humanoid then d.humanoid.AutoRotate=true end;K._phase="Idle"end;local function cA()aU()stopHover()cz()bH()b6()c3()if K.running then task.wait(0.25)K.currentInst=nil;waitForEnemies()end end;local function cB()if K._watchSelf then K._watchSelf:Disconnect()K._watchSelf=nil end end;local function cC()cB()K._watchSelf=b.Players.LocalPlayer.CharacterAdded:Connect(function()task.wait(0.35)cA()end)end;local cD=c and(c["Auto"]or c.AddTab and c:AddTab("Auto"))if not cD then error("Auto tab unavailable")end;local cE=cD:AddRightGroupbox(p.groupTitle or"AutoFarm","link")local cF,cG;local function cH(cI)local ac=aA(K.targetType)local cJ={}for a5,cK in pairs(ac)do if cK and#cK>0 then cJ[#cJ+1]=a5 end end;table.sort(cJ)cI:SetValues(cJ)end;do local cL={}for cM,a0 in pairs(n)do cL[#cL+1]=cM end;table.sort(cL)cE:AddDropdown("AF_Type",{Text="Target Type",Values=cL,Default=o.targetType or cL[1],Callback=function(bQ)K.targetType=bQ;K.selectedTargets={}if cF then cH(cF)end end})end;cF=cE:AddDropdown("AF_Target",{Text="Target",Values={},Multi=true,Callback=function(bQ)local aJ={}for a2,cN in pairs(bQ)do if cN then aJ[#aJ+1]=a2 end end;K.selectedTargets=aJ;if K.running then local bK=aN()if bK then K.currentInst=bK;startApproach()else waitForEnemies()end end end})cE:AddButton({Text="Refresh Targets",Func=function()cH(cF)end})cE:AddDropdown("AF_Mode",{Text="Mode",Values={"Behind","In Front","Left","Right","Aligned"},Default=o.mode or"Behind",Callback=function(bQ)K.mode=bQ;if K.running then startApproach()end end})cE:AddSlider("AF_Y",{Text="Y Offset",Default=o.yOffset or 10,Min=-30,Max=30,Suffix=" studs",Callback=function(bQ)K.yOffset=bQ;if K.running then startApproach()end end})cE:AddToggle("AF_On",{Text="AutoFarm",Default=false,Callback=function(cN)K.running=cN;if cN then cC()bn()bW()K.currentInst=aN()if not K.currentInst then waitForEnemies()else startApproach()end;if K.showStatus then bL()end else aU()stopHover()cB()bH()b6()cz()bU()c3()end end})cE:AddToggle("AF_Dodge",{Text="Dodge Mode",Default=o.dodgeMode or false,Callback=function(bQ)K.dodgeMode=bQ;if bQ then bn()else b6()end end})cE:AddSlider("AF_DodgeRange",{Text="Dodge Range",Default=50,Min=10,Max=200,Suffix=" studs",Callback=function(bQ)K._dodgeRange=bQ end})cE:AddToggle("AF_AutoY",{Text="AutoSet Y Offset",Default=o.autoYOffset or false,Callback=function(bQ)K.autoYOffset=bQ end})cE:AddDivider()cE:AddToggle("AF_Overrides_Enable",{Text="Enable Overrides",Default=false,Callback=function(bQ)K.overridesEnabled=bQ;if K.running then cA()end end})do local cJ={}for a2,a0 in pairs(s)do cJ[#cJ+1]=a2 end;table.sort(cJ)cG=cE:AddDropdown("AF_Overrides_Select",{Text="Active Overrides",Values=cJ,Multi=true,Default={},Callback=function(bQ)K.overrideSelection=bQ or{}if K.running then cA()end end})local cO={}for a2,a3 in pairs(s)do if a3.enabledDefault then cO[a2]=true end end;cG:SetValue(cO)K.overrideSelection=cO end;cE:AddDivider()cE:AddToggle("AF_Status",{Text="Show Status",Default=o.showStatus or false,Callback=function(cN)K.showStatus=cN;if cN then bL()else bH()end end})cE:AddToggle("AF_Safety",{Text="Safety Mode",Default=false,Tooltip="Ignore targets close to other players."})cE:AddSlider("AF_SafetyRange",{Text="Safety Range",Default=50,Min=10,Max=200,Suffix=" studs"})cH(cF)local cP={}function cP.Unload()aU()stopHover()cz()bH()b6()cB()bU()c3()if g and g.AF_On and g.AF_On.Value then pcall(function()g.AF_On:SetValue(false)end)end end;return cP end
